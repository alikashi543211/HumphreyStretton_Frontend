"use strict";(self.webpackChunkhumphree=self.webpackChunkhumphree||[]).push([[591],{2591:(Oi,P,u)=>{u.r(P),u.d(P,{AccountsModule:()=>bi});var c=u(9808),C=u(7587),e=u(5e3),D=u(8646),Z=u(9634),f=u(2116),v=u(9644),l=u(4182),h=u(6783),p=u(7051);function Q(i,r){1&i&&(e.TgZ(0,"h4",9),e._uU(1,"ADD PURCHASE ORDER"),e.qZA())}function j(i,r){1&i&&(e.TgZ(0,"h4",9),e._uU(1,"UPDATE PURCHASE ORDER"),e.qZA())}function H(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"li",37),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw(3).selectSupplier(s)}),e.TgZ(1,"strong"),e._uU(2),e.qZA()()}if(2&i){const t=r.$implicit;e.xp6(2),e.Oqu(t.name)}}function L(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",35)(1,"ul"),e.YNc(2,H,3,1,"li",36),e.TgZ(3,"li",37),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).selectSupplier("new")}),e._uU(4,"Add Supplier"),e.qZA()()()}if(2&i){const t=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",t.suppliers)}}function $(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"li",37),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw(3).selectOrder(s)}),e.TgZ(1,"strong"),e._uU(2),e.qZA(),e._uU(3," | "),e.TgZ(4,"strong"),e._uU(5,"Order #"),e.qZA(),e._uU(6),e.qZA()}if(2&i){const t=r.$implicit;e.xp6(2),e.Oqu(t.work_number),e.xp6(4),e.hij(": ",t.order_number," ")}}function V(i,r){if(1&i&&(e.TgZ(0,"div",35)(1,"ul"),e.YNc(2,$,7,2,"li",36),e.qZA()()),2&i){const t=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",t.orders)}}function z(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"span",38),e._uU(1),e.TgZ(2,"i-feather",39),e.NdJ("click",function(){const s=e.CHM(t).index;return e.oxw(2).removeOrder(s)}),e.qZA()()}if(2&i){const t=r.$implicit;e.xp6(1),e.hij(" ",t.work_number," ")}}const S=function(){return{isAnimated:!0,adaptivePosition:!0,dateInputFormat:"DD-MMM-YYYY",containerClass:"theme-red"}};function B(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",10)(1,"div",11)(2,"div",12)(3,"div",13)(4,"label",14)(5,"span",15),e._uU(6,"Order Number#"),e.qZA(),e.TgZ(7,"span",16),e._uU(8,"*"),e.qZA()(),e.TgZ(9,"input",17),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().newPurchaseOrder.order_number=o}),e.qZA()()()(),e.TgZ(10,"div",11)(11,"div",12)(12,"div",13)(13,"label",14)(14,"span",15),e._uU(15,"Value"),e.qZA(),e.TgZ(16,"span",16),e._uU(17,"*"),e.qZA()(),e.TgZ(18,"input",18),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().newPurchaseOrder.value=o}),e.qZA()()()(),e.TgZ(19,"div",19)(20,"div",20)(21,"div",21)(22,"div",22),e.NdJ("focusout",function(){return e.CHM(t),e.oxw().supplierInputOut()}),e.TgZ(23,"label",23)(24,"span",15),e._uU(25,"Supplier"),e.qZA(),e.TgZ(26,"span",16),e._uU(27,"*"),e.qZA()(),e.TgZ(28,"input",24),e.NdJ("input",function(o){return e.CHM(t),e.oxw().getSuppliers(o)})("focus",function(){return e.CHM(t),e.oxw().supplierInput=!0})("ngModelChange",function(o){return e.CHM(t),e.oxw().selectedSupplier=o}),e.qZA(),e.YNc(29,L,5,1,"div",25),e._UZ(30,"i-feather",26),e.qZA()()()(),e.TgZ(31,"div",19)(32,"div",20)(33,"div",21)(34,"div",22),e.NdJ("focusout",function(){return e.CHM(t),e.oxw().orderInputOut()}),e.TgZ(35,"label",23)(36,"span",15),e._uU(37,"Work Order Number"),e.qZA()(),e.TgZ(38,"input",27),e.NdJ("input",function(o){return e.CHM(t),e.oxw().getOrders(o)})("focus",function(){return e.CHM(t),e.oxw().orderInput=!0}),e.qZA(),e.YNc(39,V,3,1,"div",25),e._UZ(40,"i-feather",26),e.qZA()(),e.TgZ(41,"div",28),e.YNc(42,z,3,1,"span",29),e.qZA()()(),e.TgZ(43,"div",19)(44,"div",12)(45,"div",13)(46,"label",23)(47,"span",15),e._uU(48,"Date"),e.qZA(),e._UZ(49,"span",16),e.qZA(),e.TgZ(50,"div",30)(51,"input",31),e.NdJ("bsValueChange",function(o){return e.CHM(t),e.oxw().dateValue(o)}),e.qZA(),e.TgZ(52,"div",32),e._UZ(53,"i-feather",33),e.qZA()()()()(),e.TgZ(54,"div",19)(55,"div",12)(56,"div",13)(57,"label",14)(58,"span",15),e._uU(59,"Comments"),e.qZA()(),e.TgZ(60,"input",34),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().newPurchaseOrder.note=o}),e.qZA()()()()()}if(2&i){const t=e.oxw();e.xp6(9),e.Q6J("ngModel",t.newPurchaseOrder.order_number),e.xp6(9),e.Q6J("ngModel",t.newPurchaseOrder.value),e.xp6(10),e.Q6J("ngModel",t.selectedSupplier),e.xp6(1),e.Q6J("ngIf",t.supplierInput),e.xp6(10),e.Q6J("ngIf",t.orderInput),e.xp6(3),e.Q6J("ngForOf",t.selectedOrders),e.xp6(9),e.Q6J("bsConfig",e.DdM(10,S))("placement","top")("bsValue",t.currentDate),e.xp6(9),e.Q6J("ngModel",t.newPurchaseOrder.note)}}function W(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"li",37),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw(3).selectSupplier(s)}),e.TgZ(1,"strong"),e._uU(2),e.qZA()()}if(2&i){const t=r.$implicit;e.xp6(2),e.Oqu(t.name)}}function R(i,r){if(1&i&&(e.TgZ(0,"div",35)(1,"ul"),e.YNc(2,W,3,1,"li",36),e.qZA()()),2&i){const t=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",t.suppliers)}}function X(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"li",37),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw(3).selectOrder(s)}),e.TgZ(1,"strong"),e._uU(2),e.qZA(),e._uU(3," | "),e.TgZ(4,"strong"),e._uU(5,"Order #"),e.qZA(),e._uU(6),e.qZA()}if(2&i){const t=r.$implicit;e.xp6(2),e.Oqu(t.work_number),e.xp6(4),e.hij(": ",t.order_number," ")}}function G(i,r){if(1&i&&(e.TgZ(0,"div",35)(1,"ul"),e.YNc(2,X,7,2,"li",36),e.qZA()()),2&i){const t=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",t.orders)}}function K(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"span",38),e._uU(1),e.TgZ(2,"i-feather",39),e.NdJ("click",function(){const s=e.CHM(t).index;return e.oxw(2).removeOrder(s)}),e.qZA()()}if(2&i){const t=r.$implicit;e.xp6(1),e.hij(" ",t.work_number," ")}}function ee(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",10)(1,"div",11)(2,"div",12)(3,"div",13)(4,"label",14)(5,"span",15),e._uU(6,"Order Number#"),e.qZA(),e.TgZ(7,"span",16),e._uU(8,"*"),e.qZA()(),e.TgZ(9,"input",17),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().salesOrder.order_number=o}),e.qZA()()()(),e.TgZ(10,"div",11)(11,"div",12)(12,"div",13)(13,"label",14)(14,"span",15),e._uU(15,"Value"),e.qZA(),e.TgZ(16,"span",16),e._uU(17,"*"),e.qZA()(),e.TgZ(18,"input",18),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().salesOrder.value=o}),e.qZA()()()(),e.TgZ(19,"div",19)(20,"div",20)(21,"div",21)(22,"div",22),e.NdJ("focusout",function(){return e.CHM(t),e.oxw().supplierInputOut()}),e.TgZ(23,"label",23)(24,"span",15),e._uU(25,"Supplier"),e.qZA(),e.TgZ(26,"span",16),e._uU(27,"*"),e.qZA()(),e.TgZ(28,"input",24),e.NdJ("input",function(o){return e.CHM(t),e.oxw().getSuppliers(o)})("focus",function(){return e.CHM(t),e.oxw().supplierInput=!0})("ngModelChange",function(o){return e.CHM(t),e.oxw().selectedSupplier=o}),e.qZA(),e.YNc(29,R,3,1,"div",25),e._UZ(30,"i-feather",26),e.qZA()()()(),e.TgZ(31,"div",19)(32,"div",20)(33,"div",21)(34,"div",22),e.NdJ("focusout",function(){return e.CHM(t),e.oxw().orderInputOut()}),e.TgZ(35,"label",23)(36,"span",15),e._uU(37,"Work Order Number"),e.qZA()(),e.TgZ(38,"input",27),e.NdJ("input",function(o){return e.CHM(t),e.oxw().getOrders(o)})("focus",function(){return e.CHM(t),e.oxw().orderInput=!0}),e.qZA(),e.YNc(39,G,3,1,"div",25),e._UZ(40,"i-feather",26),e.qZA()(),e.TgZ(41,"div",28),e.YNc(42,K,3,1,"span",29),e.qZA()()(),e.TgZ(43,"div",19)(44,"div",12)(45,"div",13)(46,"label",23)(47,"span",15),e._uU(48,"Date"),e.qZA(),e._UZ(49,"span",16),e.qZA(),e.TgZ(50,"div",30)(51,"input",31),e.NdJ("bsValueChange",function(o){return e.CHM(t),e.oxw().dateValue(o)}),e.qZA(),e.TgZ(52,"div",32),e._UZ(53,"i-feather",33),e.qZA()()()()(),e.TgZ(54,"div",19)(55,"div",12)(56,"div",13)(57,"label",14)(58,"span",15),e._uU(59,"Comments"),e.qZA()(),e.TgZ(60,"input",34),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().salesOrder.note=o}),e.qZA()()()()()}if(2&i){const t=e.oxw();e.xp6(9),e.Q6J("ngModel",t.salesOrder.order_number),e.xp6(9),e.Q6J("ngModel",t.salesOrder.value),e.xp6(10),e.Q6J("ngModel",t.selectedSupplier),e.xp6(1),e.Q6J("ngIf",t.supplierInput),e.xp6(10),e.Q6J("ngIf",t.orderInput),e.xp6(3),e.Q6J("ngForOf",t.selectedOrders),e.xp6(9),e.Q6J("bsConfig",e.DdM(10,S))("placement","top")("bsValue",t.selectedDate),e.xp6(9),e.Q6J("ngModel",t.salesOrder.note)}}function te(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"a",40),e.NdJ("click",function(){return e.CHM(t),e.oxw().addOrder()}),e._uU(1,"Save"),e.qZA()}}function ne(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"a",40),e.NdJ("click",function(){return e.CHM(t),e.oxw().updateOrder()}),e._uU(1,"Update"),e.qZA()}}let y=(()=>{class i{constructor(t,n,o,s){this.helper=t,this._account=n,this.datePipe=o,this._modal=s,this.type="add",this.response=new e.vpe,this.newPurchaseOrder={order_number:"",value:"",supplier_id:"",work_order_id:[],due_date:"",note:""},this.orders=[],this.suppliers=[],this.selectedSupplier="",this.supplierInput=!1,this.orderInput=!1,this.selectedOrder="",this.selectedOrders=[],this.currentDate=new Date,this.modalConfig={animated:!0,keyboard:!1,backdrop:!1,ignoreBackdropClick:!0,windowClass:"modal-roles add-phone-book-modal"}}ngOnInit(){this.getOrders(),this.getSuppliers(),"edit"==this.type&&this.updateOrderObj()}updateOrderObj(){var t;this.selectedDate=new Date(this.salesOrder.due_date),this.selectedSupplier=this.salesOrder.supplier.name;let n=JSON.stringify(this.salesOrder.work_orders);this.selectedOrders=JSON.parse(n),this.salesOrder.work_order_id=[];for(let o=0;o<this.salesOrder.work_orders.length;o++)this.salesOrder.work_order_id[o]=this.salesOrder.work_orders[o].id;this.selectedOrder=null===(t=this.salesOrder.order)||void 0===t?void 0:t.work_number}getSuppliers(t=null){let n="";t&&(n=t.target.value),(n.length>=3||0==n.length)&&(this.searchSubscription&&this.searchSubscription.unsubscribe(),this._account.supplierListing({search:n}).subscribe(o=>{var s;this.suppliers=o.data.data,this.newPurchaseOrder.supplier_id=o.data.data[0]?null===(s=o.data.data[0])||void 0===s?void 0:s.id:null}))}getOrders(t=null){let n="";t&&(n=t.target.value),(n.length>=3||0==n.length)&&(this.searchSubscription&&this.searchSubscription.unsubscribe(),this._account.workOrderListing({search:n}).subscribe(o=>{this.orders=o.data.data}))}cancel(){this.response.emit({success:!1})}addOrder(){this._account.addPurchaseOrder(this.newPurchaseOrder).subscribe(t=>{this.helper.toastSuccess(t.message),this.response.emit({success:!0})})}updateOrder(){this._account.updatePurchaseOrder(this.salesOrder).subscribe(t=>{this.helper.toastSuccess(t.message),this.response.emit({success:!0,data:t.data})})}selectSupplier(t){if("new"==t){const n=this._modal.open(D.A,this.modalConfig);n.componentInstance.response.subscribe(o=>{o.success&&(this.selectedSupplier=o.data.name,this.newPurchaseOrder.supplier_id=o.data.id,"edit"==this.type&&(this.salesOrder.supplier_id=o.data.id)),n.dismiss()})}else this.selectedSupplier=t.name,this.newPurchaseOrder.supplier_id=t.id,"edit"==this.type&&(this.salesOrder.supplier_id=t.id)}selectOrder(t){var n;this.selectedOrders.find(o=>o.work_number==t.work_number)||(this.selectedOrders.push(t),this.newPurchaseOrder.work_order_id.push(t.id),null===(n=this.salesOrder)||void 0===n||n.work_order_id.push(t.id))}removeOrder(t){var n;this.selectedOrders.splice(t,1),this.newPurchaseOrder.work_order_id.splice(t,1),null===(n=this.salesOrder)||void 0===n||n.work_order_id.splice(t,1)}supplierInputOut(){setTimeout(()=>{this.supplierInput=!1},200)}orderInputOut(){setTimeout(()=>{this.orderInput=!1},200)}dateValue(t){this.newPurchaseOrder.due_date=this.datePipe.transform(t,"YYYY-MM-dd"),"edit"==this.type&&(this.salesOrder.due_date=this.datePipe.transform(t,"YYYY-MM-dd"))}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(Z.B),e.Y36(f.B),e.Y36(c.uU),e.Y36(v.FF))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-add-edit-account-purchase-order"]],inputs:{type:"type",salesOrder:"salesOrder"},outputs:{response:"response"},decls:14,vars:6,consts:[[1,"modal-header"],["class","modal-title",4,"ngIf"],["type","button","data-dismiss","modal",1,"close"],[1,"modal-body"],["class","row",4,"ngIf"],[1,"modal-footer"],[1,"d-flex","align-items-center","justify-content-center","w-100"],["href","javascript:void(0)",1,"discard-btn",3,"click"],["href","javascript:void(0)","class","add-btn",3,"click",4,"ngIf"],[1,"modal-title"],[1,"row"],[1,"col-md-6"],[1,"search-inputs","mb-2"],[1,"input-style"],[1,"d-block","red-label"],[1,"red-label"],[1,"text-danger"],["type","text","placeholder","add order number",1,"ctm-input","type-input",3,"ngModel","ngModelChange"],["type","text","placeholder","0",1,"ctm-input","type-input",3,"ngModel","ngModelChange"],[1,"col-md-12"],[1,"input-style","mb-2"],[1,"select-box"],[1,"form-group","position-relative",3,"focusout"],[1,"d-block"],["type","text","placeholder","Search supplier",1,"ctm-input","type-input",3,"ngModel","input","focus","ngModelChange"],["class","custom-dropdown-list",4,"ngIf"],["name","search",1,"input-icon"],["type","text","placeholder","Search work orders",1,"ctm-input","type-input",3,"input","focus"],[1,"d-flex","flex-wrap"],["class","fiels-ctm",4,"ngFor","ngForOf"],[1,"type-pass"],["type","text","id","start_date","placeholder","Select Date","name","start_date","bsDatepicker","",1,"ctm-input",3,"bsConfig","placement","bsValue","bsValueChange"],[1,"icon-eye","d-flex","align-items-center","justify-content-center"],["name","calendar",1,"calender"],["type","text","placeholder","Note",1,"ctm-input","type-input",3,"ngModel","ngModelChange"],[1,"custom-dropdown-list"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[1,"fiels-ctm"],["name","X",1,"remove-product",3,"click"],["href","javascript:void(0)",1,"add-btn",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.YNc(1,Q,2,0,"h4",1),e.YNc(2,j,2,0,"h4",1),e.TgZ(3,"button",2),e._uU(4,"\xd7"),e.qZA()(),e.TgZ(5,"div",3),e.YNc(6,B,61,11,"div",4),e.YNc(7,ee,61,11,"div",4),e.qZA(),e.TgZ(8,"div",5)(9,"div",6)(10,"a",7),e.NdJ("click",function(){return n.cancel()}),e._uU(11,"Discard"),e.qZA(),e.YNc(12,te,2,0,"a",8),e.YNc(13,ne,2,0,"a",8),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("ngIf","add"==n.type),e.xp6(1),e.Q6J("ngIf","edit"==n.type),e.xp6(4),e.Q6J("ngIf","add"==n.type),e.xp6(1),e.Q6J("ngIf","edit"==n.type),e.xp6(5),e.Q6J("ngIf","add"==n.type),e.xp6(1),e.Q6J("ngIf","edit"==n.type))},directives:[c.O5,l.Fj,l.JJ,l.On,c.sg,h.u,p.Y5,p.Np],styles:[".search-inputs[_ngcontent-%COMP%]   .input-style[_ngcontent-%COMP%]   .ctm-input.type-input[_ngcontent-%COMP%]{width:100%}"]}),i})();var ie=u(1628);function oe(i,r){1&i&&(e.TgZ(0,"h4",9),e._uU(1,"ADD SALES ORDER"),e.qZA())}function re(i,r){1&i&&(e.TgZ(0,"h4",9),e._uU(1,"UPDATE SALES ORDER"),e.qZA())}function se(i,r){if(1&i&&(e.TgZ(0,"span"),e._uU(1," | "),e.TgZ(2,"strong"),e._uU(3,"Contract "),e.qZA(),e._uU(4),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(4),e.hij(": ",t.contract,"")}}function ae(i,r){if(1&i&&(e.TgZ(0,"span"),e._uU(1," | "),e.TgZ(2,"strong"),e._uU(3,"Phone No "),e.qZA(),e._uU(4),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(4),e.hij(": ",t.phone_no,"")}}function ce(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"li",35),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw(3).selectCustomer(s)}),e.TgZ(1,"strong"),e._uU(2),e.qZA(),e.YNc(3,se,5,1,"span",28),e.YNc(4,ae,5,1,"span",28),e.qZA()}if(2&i){const t=r.$implicit;e.xp6(2),e.Oqu(t.name),e.xp6(1),e.Q6J("ngIf",t.contract),e.xp6(1),e.Q6J("ngIf",t.phone_no)}}function de(i,r){if(1&i&&(e.TgZ(0,"div",33)(1,"ul"),e.YNc(2,ce,5,3,"li",34),e.qZA()()),2&i){const t=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",t.customers)}}function le(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"li",37),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw(3).selectOrder(s)}),e.TgZ(1,"strong"),e._uU(2),e.qZA(),e._uU(3," | "),e.TgZ(4,"strong"),e._uU(5,"Customer "),e.qZA(),e._uU(6),e.TgZ(7,"strong"),e._uU(8,"Contract "),e.qZA(),e._uU(9),e.qZA()}if(2&i){const t=r.$implicit,n=e.oxw(3);e.Q6J("hidden",n.checkSelectedOrder(t))("ngClass",n.selectedCustomer&&n.selectedCustomer!=t.customer.name?"disabled":""),e.xp6(2),e.Oqu(t.work_number),e.xp6(4),e.hij(": ",t.customer.name," | "),e.xp6(3),e.hij(": ",t.contract," ")}}function _e(i,r){if(1&i&&(e.TgZ(0,"div",33)(1,"ul"),e.YNc(2,le,10,5,"li",36),e.qZA()()),2&i){const t=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",t.orders)}}function ue(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"span",38),e._uU(1),e.TgZ(2,"span")(3,"i-feather",39),e.NdJ("click",function(){const s=e.CHM(t).index;return e.oxw(2).removeOrder(s)}),e.qZA()()()}if(2&i){const t=r.$implicit;e.xp6(1),e.hij(" ",t.model.work_number," ")}}function pe(i,r){if(1&i&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA()()),2&i){const t=r.$implicit;e.xp6(2),e.Oqu(t.model.customer.name),e.xp6(2),e.Oqu(t.model.product.name),e.xp6(2),e.Oqu(t.model.order_number),e.xp6(2),e.Oqu(t.model.contract)}}function he(i,r){1&i&&(e.TgZ(0,"tr")(1,"td",40),e._uU(2,"No Order Selected"),e.qZA()())}function me(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"input",55),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().$implicit.model.quotation.delivery_fee=o}),e.qZA()}if(2&i){const t=e.oxw().$implicit;e.Q6J("ngModel",t.model.quotation.delivery_fee)}}function ge(i,r){1&i&&e._UZ(0,"input",56)}const J=function(){return{isAnimated:!0,adaptivePosition:!0,dateInputFormat:"DD-MMM-YYYY",containerClass:"theme-red"}};function fe(i,r){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",12)(2,"div",41)(3,"label",16),e._uU(4,"Value "),e.TgZ(5,"span",17),e._uU(6),e.qZA(),e._UZ(7,"span",18),e.qZA()(),e.TgZ(8,"div",42)(9,"div",43)(10,"label",16),e._uU(11),e.qZA(),e.TgZ(12,"div",44)(13,"input",45),e.NdJ("ngModelChange",function(o){return e.CHM(t).$implicit.value=o}),e.qZA(),e.TgZ(14,"div",46),e._UZ(15,"img",47),e.qZA()()(),e.TgZ(16,"div",43)(17,"label",16),e._uU(18,"Other"),e.qZA(),e.TgZ(19,"div",44)(20,"input",45),e.NdJ("ngModelChange",function(o){return e.CHM(t).$implicit.other=o}),e.qZA(),e.TgZ(21,"div",46),e._UZ(22,"img",47),e.qZA()()(),e.TgZ(23,"div",41)(24,"label",16),e._uU(25,"Delivery Fee"),e.qZA(),e.TgZ(26,"div",44),e.YNc(27,me,1,1,"input",48),e.YNc(28,ge,1,0,"input",49),e.TgZ(29,"div",46),e._UZ(30,"img",47),e.qZA()()(),e.TgZ(31,"div",43)(32,"label",16),e._uU(33,"Due Date"),e.qZA(),e.TgZ(34,"div",44)(35,"input",50),e.NdJ("ngModelChange",function(o){return e.CHM(t).$implicit.month=o}),e.qZA()()(),e.TgZ(36,"div",51)(37,"label",52)(38,"input",53),e.NdJ("change",function(o){const a=e.CHM(t).index;return e.oxw(2).addDueDateStatus(o,a)}),e.qZA(),e._UZ(39,"span",54),e.qZA()()()(),e.BQk()}if(2&i){const t=r.$implicit;e.xp6(6),e.Oqu(t.model.work_number),e.xp6(5),e.Oqu(t.model.product.name),e.xp6(2),e.Q6J("ngModel",t.value),e.xp6(7),e.Q6J("ngModel",t.other),e.xp6(7),e.Q6J("ngIf",t.model.quotation&&(null==t.model.quotation?null:t.model.quotation.delivery_fee)),e.xp6(1),e.Q6J("ngIf",!t.model.quotation||!(null!=t.model.quotation&&t.model.quotation.delivery_fee)),e.xp6(7),e.Q6J("ngModel",t.month)("bsConfig",e.DdM(11,J))("placement","top")("bsValue",t.month),e.xp6(3),e.Q6J("checked",!1)}}function Ce(i,r){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.hij("| ",t.role.title,"")}}function Ze(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"li",35),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw(3).selectEmployee(s)}),e.TgZ(1,"strong"),e._uU(2),e.qZA(),e.YNc(3,Ce,2,1,"span",28),e._uU(4," | "),e.TgZ(5,"strong"),e._uU(6),e.qZA()()}if(2&i){const t=r.$implicit;e.xp6(2),e.Oqu(t.name),e.xp6(1),e.Q6J("ngIf",t.role_id),e.xp6(3),e.Oqu(t.email)}}function ve(i,r){if(1&i&&(e.TgZ(0,"div",33)(1,"ul"),e.YNc(2,Ze,7,3,"li",34),e.qZA()()),2&i){const t=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",t.employees)}}function Te(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",10)(1,"div",11)(2,"div",12)(3,"div",13)(4,"div",14)(5,"div",15),e.NdJ("focusout",function(){return e.CHM(t),e.oxw().customerInputOut()}),e.TgZ(6,"label",16)(7,"span",17),e._uU(8,"Customers"),e.qZA(),e.TgZ(9,"span",18),e._uU(10,"*"),e.qZA()(),e.TgZ(11,"input",19),e.NdJ("input",function(o){return e.CHM(t),e.oxw().searchCustomers(o)})("focus",function(){return e.CHM(t),e.oxw().customerInput=!0})("ngModelChange",function(o){return e.CHM(t),e.oxw().selectedCustomer=o}),e.qZA(),e.YNc(12,de,3,1,"div",20),e._UZ(13,"i-feather",21),e.qZA()()()(),e.TgZ(14,"div",12)(15,"div",13)(16,"div",14)(17,"div",15),e.NdJ("focusout",function(){return e.CHM(t),e.oxw().orderInputOut()}),e.TgZ(18,"label",16)(19,"span",17),e._uU(20,"Work Order Number"),e.qZA(),e.TgZ(21,"span",18),e._uU(22,"*"),e.qZA()(),e.TgZ(23,"input",22),e.NdJ("input",function(o){return e.CHM(t),e.oxw().searchOrder(o)})("focus",function(){return e.CHM(t),e.oxw().orderInput=!0}),e.qZA(),e.YNc(24,_e,3,1,"div",20),e._UZ(25,"i-feather",21),e.qZA(),e.TgZ(26,"div",23),e.YNc(27,ue,4,1,"span",24),e.qZA()()()(),e.TgZ(28,"div",12)(29,"div",25)(30,"table",26)(31,"thead")(32,"tr")(33,"th"),e._uU(34,"Customer"),e.qZA(),e.TgZ(35,"th"),e._uU(36,"Product"),e.qZA(),e.TgZ(37,"th"),e._uU(38,"Customer Order#"),e.qZA(),e.TgZ(39,"th"),e._uU(40,"Contract"),e.qZA()()(),e.TgZ(41,"tbody"),e.YNc(42,pe,9,4,"tr",27),e.YNc(43,he,3,0,"tr",28),e.qZA()()()()(),e.TgZ(44,"div",29)(45,"div",11),e.YNc(46,fe,40,12,"ng-container",27),e.TgZ(47,"div",12)(48,"div",13)(49,"div",14)(50,"div",15),e.NdJ("focusout",function(){return e.CHM(t),e.oxw().employeeInputOut()}),e.TgZ(51,"label",16)(52,"span",17),e._uU(53,"Sales Person"),e.qZA(),e.TgZ(54,"span",18),e._uU(55,"*"),e.qZA()(),e.TgZ(56,"input",30),e.NdJ("input",function(o){return e.CHM(t),e.oxw().getEmployees(o)})("focus",function(){return e.CHM(t),e.oxw().employeeInput=!0})("ngModelChange",function(o){return e.CHM(t),e.oxw().selectedEmployee=o}),e.qZA(),e.YNc(57,ve,3,1,"div",20),e._UZ(58,"i-feather",21),e.qZA()()()(),e.TgZ(59,"div",12)(60,"div",31)(61,"label",16)(62,"span",17),e._uU(63,"Notes"),e.qZA()(),e.TgZ(64,"input",32),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().newSalesOrder.delivery_note=o}),e.qZA()()()()()()}if(2&i){const t=e.oxw();e.xp6(11),e.Q6J("ngModel",t.selectedCustomer),e.xp6(1),e.Q6J("ngIf",t.customerInput),e.xp6(12),e.Q6J("ngIf",t.orderInput),e.xp6(3),e.Q6J("ngForOf",t.selectedOrders),e.xp6(15),e.Q6J("ngForOf",t.selectedOrders),e.xp6(1),e.Q6J("ngIf",0==t.selectedOrders.length),e.xp6(3),e.Q6J("ngForOf",t.selectedOrders),e.xp6(10),e.Q6J("ngModel",t.selectedEmployee),e.xp6(1),e.Q6J("ngIf",t.employeeInput),e.xp6(7),e.Q6J("ngModel",t.newSalesOrder.delivery_note)}}function Ae(i,r){1&i&&e._UZ(0,"input",56)}function xe(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"input",55),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw(2).salesOrder.work_order.quotation.delivery_fee=o}),e.qZA()}if(2&i){const t=e.oxw(2);e.Q6J("ngModel",t.salesOrder.work_order.quotation.delivery_fee)}}function be(i,r){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.hij("| ",t.role.title,"")}}function Oe(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"li",35),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw(3).selectEmployee(s)}),e.TgZ(1,"strong"),e._uU(2),e.qZA(),e.YNc(3,be,2,1,"span",28),e._uU(4," | "),e.TgZ(5,"strong"),e._uU(6),e.qZA()()}if(2&i){const t=r.$implicit;e.xp6(2),e.Oqu(t.name),e.xp6(1),e.Q6J("ngIf",t.role_id),e.xp6(3),e.Oqu(t.email)}}function ke(i,r){if(1&i&&(e.TgZ(0,"div",33)(1,"ul"),e.YNc(2,Oe,7,3,"li",34),e.qZA()()),2&i){const t=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",t.employees)}}function qe(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",57)(1,"div",11)(2,"div",12)(3,"div",13)(4,"div",14)(5,"div",15),e.NdJ("focusout",function(){return e.CHM(t),e.oxw().orderInputOut()}),e.TgZ(6,"label",16)(7,"span",17),e._uU(8,"Work Order Number"),e.qZA(),e.TgZ(9,"span",18),e._uU(10,"*"),e.qZA()(),e.TgZ(11,"input",58),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().selectedOrder=o}),e.qZA()()()()()(),e.TgZ(12,"div",11)(13,"div",12)(14,"div",41)(15,"label",16),e._uU(16,"Value "),e.TgZ(17,"span",17),e._uU(18),e.qZA(),e._UZ(19,"span",18),e.qZA()(),e.TgZ(20,"div",42)(21,"div",41)(22,"label",16),e._uU(23),e.qZA(),e.TgZ(24,"div",44)(25,"input",59),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().salesOrder.value=o}),e.qZA(),e.TgZ(26,"div",46),e._UZ(27,"img",47),e.qZA()()(),e.TgZ(28,"div",41)(29,"label",16),e._uU(30,"Other"),e.qZA(),e.TgZ(31,"div",44)(32,"input",59),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().salesOrder.other=o}),e.qZA(),e.TgZ(33,"div",46),e._UZ(34,"img",47),e.qZA()()()()(),e.TgZ(35,"div",12)(36,"div",60)(37,"div",41)(38,"label",16),e._uU(39,"Delivery Fee"),e.qZA(),e.TgZ(40,"div",44),e.YNc(41,Ae,1,0,"input",49),e.YNc(42,xe,1,1,"input",48),e.TgZ(43,"div",46),e._UZ(44,"img",47),e.qZA()()(),e.TgZ(45,"div",61)(46,"label",16),e._uU(47,"Due Date"),e.qZA(),e.TgZ(48,"div",44)(49,"input",50),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().selectedDate=o}),e.qZA()()(),e.TgZ(50,"div",51)(51,"label",52)(52,"input",53),e.NdJ("change",function(o){return e.CHM(t),e.oxw().updateDueDateStatus(o)}),e.qZA(),e._UZ(53,"span",54),e.qZA()()()(),e.TgZ(54,"div",12)(55,"div",13)(56,"div",14)(57,"div",15),e.NdJ("focusout",function(){return e.CHM(t),e.oxw().employeeInputOut()}),e.TgZ(58,"label",16)(59,"span",17),e._uU(60,"Sales Person"),e.qZA(),e.TgZ(61,"span",18),e._uU(62,"*"),e.qZA()(),e.TgZ(63,"input",30),e.NdJ("input",function(o){return e.CHM(t),e.oxw().getEmployees(o)})("focus",function(){return e.CHM(t),e.oxw().employeeInput=!0})("ngModelChange",function(o){return e.CHM(t),e.oxw().selectedEmployee=o}),e.qZA(),e.YNc(64,ke,3,1,"div",20),e._UZ(65,"i-feather",21),e.qZA()()()(),e.TgZ(66,"div",12)(67,"div",31)(68,"label",16)(69,"span",17),e._uU(70,"Notes"),e.qZA()(),e.TgZ(71,"input",32),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().salesOrder.delivery_note=o}),e.qZA()()()()()}if(2&i){const t=e.oxw();e.xp6(11),e.Q6J("ngModel",t.selectedOrder),e.xp6(7),e.Oqu(t.salesOrder.work_order.work_number),e.xp6(5),e.Oqu(t.salesOrder.work_order.product.name),e.xp6(2),e.Q6J("ngModel",t.salesOrder.value),e.xp6(7),e.Q6J("ngModel",t.salesOrder.other),e.xp6(9),e.Q6J("ngIf",!t.salesOrder.work_order.quotation),e.xp6(1),e.Q6J("ngIf",t.salesOrder.work_order.quotation),e.xp6(7),e.Q6J("ngModel",t.selectedDate)("bsConfig",e.DdM(15,J))("placement","right")("bsValue",t.selectedDate),e.xp6(3),e.Q6J("checked",!1),e.xp6(11),e.Q6J("ngModel",t.selectedEmployee),e.xp6(1),e.Q6J("ngIf",t.employeeInput),e.xp6(7),e.Q6J("ngModel",t.salesOrder.delivery_note)}}function we(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"a",62),e.NdJ("click",function(){return e.CHM(t),e.oxw().addOrder()}),e._uU(1,"Add"),e.qZA()}}function Ue(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"a",62),e.NdJ("click",function(){return e.CHM(t),e.oxw().updateOrder()}),e._uU(1,"Update"),e.qZA()}}let M=(()=>{class i{constructor(t,n,o,s){this.helper=t,this._account=n,this._administration=o,this.datePipe=s,this.type="add",this.response=new e.vpe,this.orders=[],this.selectedOrders=[],this.searchParams={search:""},this.employees=[],this.newSalesOrder={work_orders:this.selectedOrders,delivery_note:"",user_id:null},this.selectedOrder="",this.orderInput=!1,this.employeeInput=!1,this.customerInput=!1,this.selectedEmployee="",this.selectedCustomer="",this.currentDate=new Date,this.customers=[]}ngOnInit(){console.log("sale orers",this.salesOrder),this.getCustomers(),this.getEmployees(),"edit"==this.type&&this.mapUpdateObj()}mapUpdateObj(){this.selectedDate=new Date(this.salesOrder.month),this.selectedOrder=this.salesOrder.work_order.work_number,this.selectedEmployee=this.salesOrder.user.name,this.salesOrder.is_update_work_order=!1}getEmployees(t=null){let n="";t&&(n=t.target.value),(n.length>=3||0==n.length)&&(this.searchSubscription&&this.searchSubscription.unsubscribe(),this._account.usersListing({search:n}).subscribe(o=>{var s,a;this.employees=o.data.data,this.newSalesOrder.user_id=o.data.data[0]?null===(s=o.data.data[0])||void 0===s?void 0:s.id:null,"edit"==this.type&&(this.selectedEmployee=null===(a=this.employees.find(d=>d.id==this.salesOrder.user_id))||void 0===a?void 0:a.name)}))}selectOrder(t){if(console.log(t),"edit"==this.type)return this.selectedOrder=t.work_number,void(this.salesOrder.work_order_id=t.id);if(this.selectedOrders.find(o=>o.id==t.id))return;let n={work_order_id:t.id,number:t.work_number,model:t,month:new Date(t.due_date)};"add"==this.type&&(n.is_update_work_order=!1),this.selectedCustomer?this.selectedCustomer==t.customer.name&&this.selectedOrders.push(n):(this.selectCustomer(t.customer),this.selectedOrders.push(n))}selectEmployee(t){this.selectedEmployee=t.name,this.newSalesOrder.user_id=t.id,this.salesOrder.user_id=t.id}searchOrder(t){console.log("search order",t.target.value);let n="";t&&(this.searchParams.search=t.target.value,n=t.target.value),(n.length>=3||0==n.length)&&(this.searchSubscription&&this.searchSubscription.unsubscribe(),this.searchSubscription=this._account.salesOrdersRodListing(this.searchParams).subscribe(o=>{console.log("orders",o.data.data),this.orders=o.data.data}))}searchCustomers(t){let n="";t&&(n=t.target.value),(n.length>=3||0==n.length)&&(this.searchSubscription&&this.searchSubscription.unsubscribe(),this.searchSubscription=this._account.customersListing({search:n}).subscribe(o=>{this.customers=o.data.data}))}checkSelectedOrder(t){return!!this.selectedOrders.find(n=>n.work_order_id==t.id)}getCustomers(){this._account.customersListing().subscribe(t=>{this.customers=t.data.data})}selectCustomer(t){this.selectedCustomer=t.name.trim(),this.customerInput=!1,this.selectedOrders=[],this.getOrders()}getOrders(t=null){this._account.salesOrdersRodListing(this.searchParams).subscribe(o=>{this.orders=o.data.data})}cancel(){this.response.emit({success:!1})}addOrder(){this.validateOrder()&&(this.selectedOrders.map(t=>(t.month=this.datePipe.transform(t.month,"YYYY-MM-dd"),t)),this.newSalesOrder.work_orders=this.selectedOrders,this._account.addSalesOrder(this.newSalesOrder).subscribe(t=>{this.helper.toastSuccess(t.message),this.response.emit({success:!0})}))}validateOrder(){for(let t=0;t<this.selectedOrders.length;t++){if(console.log(this.selectedOrders[t]),!this.selectedOrders[t].value||!this.selectedOrders[t].other)return this.helper.toastError(`Please enter other or ${this.selectedOrders[t].model.product.name}.`),!1;if(this.selectedOrders[t].value<0||this.selectedOrders[t].other<0)return this.helper.toastError(`Please enter other or ${this.selectedOrders[t].model.product.name}.`),!1}return!0}updateOrder(){this.salesOrder.other<0||this.salesOrder.value<0||null==this.salesOrder.other||null==this.salesOrder.value?this.helper.toastError(`Please enter other or ${this.salesOrder.work_order.product.name} price.`):(this.salesOrder.month=this.datePipe.transform(this.selectedDate,"YYYY-MM-dd"),this._account.updateSaleOrder(this.salesOrder).subscribe(t=>{this.helper.toastSuccess(t.message),this.response.emit({success:!0,data:t.data})}))}removeOrder(t){this.selectedOrders.splice(t,1)}orderInputOut(){setTimeout(()=>{this.orderInput=!1},200)}customerInputOut(){setTimeout(()=>{this.customerInput=!1},200)}employeeInputOut(){setTimeout(()=>{this.employeeInput=!1},200)}addDueDateStatus(t,n){this.selectedOrders[n].is_update_work_order=t.target.checked}updateDueDateStatus(t){this.salesOrder.is_update_work_order=t.target.checked}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(Z.B),e.Y36(f.B),e.Y36(ie.E),e.Y36(c.uU))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-add-edit-account-sales-order"]],inputs:{type:"type",salesOrder:"salesOrder"},outputs:{response:"response"},decls:13,vars:6,consts:[[1,"modal-header"],["class","modal-title",4,"ngIf"],["type","button","data-dismiss","modal",1,"close"],["class","modal-body add-modal",4,"ngIf"],["class","modal-body",4,"ngIf"],[1,"modal-footer"],[1,"d-flex","align-items-center","justify-content-center","w-100"],["href","javascript:void(0)",1,"discard-btn",3,"click"],["href","javascript:void(0)","class","add-btn",3,"click",4,"ngIf"],[1,"modal-title"],[1,"modal-body","add-modal"],[1,"row"],[1,"col-md-12"],[1,"input-style","mb-2"],[1,"select-box"],[1,"form-group","position-relative",3,"focusout"],[1,"d-block"],[1,"red-label"],[1,"text-danger"],["type","text","placeholder","Search customers",1,"ctm-input","type-input",3,"ngModel","input","focus","ngModelChange"],["class","custom-dropdown-list",4,"ngIf"],["name","search",1,"input-icon"],["type","text","placeholder","Search work orders",1,"ctm-input","type-input",3,"input","focus"],[1,"d-flex","flex-wrap"],["class","fiels-ctm",4,"ngFor","ngForOf"],[1,"table-sales-modal","table-responsive"],[1,"table","table-borderless"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"sales-order-main-box"],["type","text","placeholder","Search sales person",1,"ctm-input","type-input",3,"ngModel","input","focus","ngModelChange"],[1,"input-style","input-style-red","mb-2"],["type","text","placeholder","Additional Notes",1,"ctm-input","type-input",3,"ngModel","ngModelChange"],[1,"custom-dropdown-list"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[3,"hidden","ngClass","click",4,"ngFor","ngForOf"],[3,"hidden","ngClass","click"],[1,"fiels-ctm"],["name","plus",1,"plus-rotate",3,"click"],["colspan","4",1,"text-center"],[1,"input-style"],[1,"search-inputs","mb-2","d-flex","justify-content-between","align-center"],[1,"input-style","px-1"],[1,"type-pass"],["type","text","placeholder","",1,"ctm-input",3,"ngModel","ngModelChange"],[1,"icon-eye","d-flex","align-items-center","justify-content-center"],["src","assets/img/ipnut-pound.png","alt","pound"],["type","number","class","ctm-input","placeholder","","readonly","",3,"ngModel","ngModelChange",4,"ngIf"],["type","number","class","ctm-input","placeholder","","readonly","","value","0",4,"ngIf"],["type","text","placeholder","","bsDatepicker","",1,"ctm-input","set-padding",3,"ngModel","bsConfig","placement","bsValue","ngModelChange"],[1,"checkbox-width"],[1,"custom-check"],["type","checkbox",3,"checked","change"],["placement","top","ngbTooltip","Fix Date","tooltipClass","checkbox-tooltip",1,"checkmark"],["type","number","placeholder","","readonly","",1,"ctm-input",3,"ngModel","ngModelChange"],["type","number","placeholder","","readonly","","value","0",1,"ctm-input"],[1,"modal-body"],["type","text","placeholder","Search work orders","readonly","",1,"ctm-input","type-input",3,"ngModel","ngModelChange"],["type","number","placeholder","",1,"ctm-input",3,"ngModel","ngModelChange"],[1,"search-inputs","mb-2","d-flex","align-center"],[1,"input-style","mx-1"],["href","javascript:void(0)",1,"add-btn",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.YNc(1,oe,2,0,"h4",1),e.YNc(2,re,2,0,"h4",1),e.TgZ(3,"button",2),e._uU(4,"\xd7"),e.qZA()(),e.YNc(5,Te,65,10,"div",3),e.YNc(6,qe,72,16,"div",4),e.TgZ(7,"div",5)(8,"div",6)(9,"a",7),e.NdJ("click",function(){return n.cancel()}),e._uU(10,"Discard"),e.qZA(),e.YNc(11,we,2,0,"a",8),e.YNc(12,Ue,2,0,"a",8),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("ngIf","add"==n.type),e.xp6(1),e.Q6J("ngIf","edit"==n.type),e.xp6(3),e.Q6J("ngIf","add"==n.type),e.xp6(1),e.Q6J("ngIf","edit"==n.type),e.xp6(5),e.Q6J("ngIf","add"==n.type),e.xp6(1),e.Q6J("ngIf","edit"==n.type))},directives:[c.O5,l.Fj,l.JJ,l.On,c.sg,h.u,c.mk,l.wV,p.Y5,p.Np,v._L],styles:[".align-center[_ngcontent-%COMP%]{align-items:center}.checkbox-width[_ngcontent-%COMP%]{width:7%}.set-padding[_ngcontent-%COMP%]{padding:0rem 1rem!important}.fix-date-label[_ngcontent-%COMP%]{margin-top:-20px;margin-bottom:14px}.disabled[_ngcontent-%COMP%]{pointer-events:none;opacity:.6}.add-modal[_ngcontent-%COMP%]{padding-left:20px;overflow-y:auto;overflow-x:clip;max-height:65vh;padding-right:20px!important}@media (max-width: 1370px){.add-modal[_ngcontent-%COMP%]{max-height:80vh}}"]}),i})();var Pe=u(4279);const Se=["searchInput"];function ye(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"li",24),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw(2).selectOrder(s)}),e.TgZ(1,"strong"),e._uU(2),e.qZA(),e._uU(3," | "),e.TgZ(4,"strong"),e._uU(5,"Customer "),e.qZA(),e._uU(6),e.TgZ(7,"strong"),e._uU(8,"Contract "),e.qZA(),e._uU(9),e.qZA()}if(2&i){const t=r.$implicit;e.xp6(2),e.Oqu(t.work_order.work_number),e.xp6(4),e.hij(": ",t.work_order.customer.name," | "),e.xp6(3),e.hij(": ",t.work_order.contract," ")}}function Je(i,r){if(1&i&&(e.TgZ(0,"div",22)(1,"ul"),e.YNc(2,ye,10,3,"li",23),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.Q6J("ngForOf",t.orders)}}function Me(i,r){if(1&i&&(e.TgZ(0,"span",10),e._uU(1),e.qZA()),2&i){const t=r.$implicit;e.xp6(1),e.Oqu(t)}}function Ne(i,r){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",5)(2,"div",25)(3,"label",9),e._uU(4,"Value "),e.YNc(5,Me,2,1,"span",26),e._UZ(6,"span",11),e.qZA(),e.TgZ(7,"span",27)(8,"i-feather",28),e.NdJ("click",function(){const s=e.CHM(t).index;return e.oxw().removeOrder(s)}),e.qZA()()(),e.TgZ(9,"div",29)(10,"div",30)(11,"label",9),e._uU(12,"Quantity"),e.qZA(),e.TgZ(13,"div",31),e._UZ(14,"input",32),e.qZA()(),e.TgZ(15,"div",30)(16,"label",9),e._uU(17,"Doors"),e.qZA(),e.TgZ(18,"div",31),e._UZ(19,"input",32),e.TgZ(20,"div",33),e._UZ(21,"img",34),e.qZA()()(),e.TgZ(22,"div",30)(23,"label",9),e._uU(24,"Frame"),e.qZA(),e.TgZ(25,"div",31),e._UZ(26,"input",32),e.TgZ(27,"div",33),e._UZ(28,"img",34),e.qZA()()(),e.TgZ(29,"div",30)(30,"label",9),e._uU(31,"Other"),e.qZA(),e.TgZ(32,"div",31),e._UZ(33,"input",32),e.TgZ(34,"div",33),e._UZ(35,"img",34),e.qZA()()(),e.TgZ(36,"div",35)(37,"label",9),e._uU(38,"Delivery Fee"),e.qZA(),e.TgZ(39,"div",31),e._UZ(40,"input",36),e.TgZ(41,"div",33),e._UZ(42,"img",34),e.qZA()()(),e.TgZ(43,"div",30)(44,"label",9),e._uU(45,"Total"),e.qZA(),e.TgZ(46,"div",31),e._UZ(47,"input",37),e.TgZ(48,"div",33),e._UZ(49,"img",34),e.qZA()()()()(),e.BQk()}if(2&i){const t=r.$implicit;e.xp6(5),e.Q6J("ngForOf",t.work_number),e.xp6(9),e.Q6J("value",t.products),e.xp6(5),e.Q6J("value",t.Doors),e.xp6(7),e.Q6J("value",t.Frame),e.xp6(7),e.Q6J("value",t.other),e.xp6(7),e.Q6J("value",t.delivery_fee),e.xp6(7),e.Q6J("value",t.total)}}function Ie(i,r){if(1&i&&(e.TgZ(0,"div",4)(1,"div",5)(2,"div",25)(3,"label",38),e._uU(4,"Grand Total"),e.qZA()(),e.TgZ(5,"div",29)(6,"div",30)(7,"label",9),e._uU(8,"Quantity"),e.qZA(),e.TgZ(9,"div",31),e._UZ(10,"input",32),e.qZA()(),e.TgZ(11,"div",30)(12,"label",9),e._uU(13,"Doors"),e.qZA(),e.TgZ(14,"div",31),e._UZ(15,"input",32),e.TgZ(16,"div",33),e._UZ(17,"img",34),e.qZA()()(),e.TgZ(18,"div",30)(19,"label",9),e._uU(20,"Frame"),e.qZA(),e.TgZ(21,"div",31),e._UZ(22,"input",32),e.TgZ(23,"div",33),e._UZ(24,"img",34),e.qZA()()(),e.TgZ(25,"div",30)(26,"label",9),e._uU(27,"Other"),e.qZA(),e.TgZ(28,"div",31),e._UZ(29,"input",32),e.TgZ(30,"div",33),e._UZ(31,"img",34),e.qZA()()(),e.TgZ(32,"div",35)(33,"label",9),e._uU(34,"Delivery Fee"),e.qZA(),e.TgZ(35,"div",31),e._UZ(36,"input",36),e.TgZ(37,"div",33),e._UZ(38,"img",34),e.qZA()()(),e.TgZ(39,"div",30)(40,"label",9),e._uU(41,"Total"),e.qZA(),e.TgZ(42,"div",31),e._UZ(43,"input",37),e.TgZ(44,"div",33),e._UZ(45,"img",34),e.qZA()()()()()()),2&i){const t=e.oxw();e.xp6(10),e.Q6J("value",t.grandTotal.quantity),e.xp6(5),e.Q6J("value",t.grandTotal.doors),e.xp6(7),e.Q6J("value",t.grandTotal.frame),e.xp6(7),e.Q6J("value",t.grandTotal.other),e.xp6(7),e.Q6J("value",t.grandTotal.delivery_fee),e.xp6(7),e.Q6J("value",t.grandTotal.total)}}let Fe=(()=>{class i{constructor(t,n,o){this._fsc=t,this._account=n,this.datePipe=o,this.orders=[],this.selectedOrders=[],this.orderInput=!1,this.grandTotal={total:0,quantity:0,doors:0,frame:0,other:0,delivery_fee:0},this.searchParams={search:"",month:""},this.accountsMonth=new Date,this.response=new e.vpe,this.searchParams.month=this.datePipe.transform(this.accountsMonth,"YYYY-MM")}ngOnInit(){this.getWorkOrders()}getWorkOrders(t=null){this.searchSubscription&&this.searchSubscription.unsubscribe(),this._account.salesOrders(this.searchParams).subscribe(o=>{this.orders=o.data.data})}selectOrder(t){var n,o,s,a,d;if(this.searchInput.nativeElement.value="",this.isExist(t))console.log("found it");else if(null===(n=t.work_order)||void 0===n?void 0:n.quotation){let m=0;for(let _=0;_<this.selectedOrders.length;_++)if(this.selectedOrders[_].quotation&&this.selectedOrders[_].quotation==t.work_order.quotation.id){this.selectedOrders[_].id.push(t.id),this.selectedOrders[_].work_number.push(t.work_order.work_number),this.selectedOrders[_].products=this.selectedOrders[_].products+t.work_order.quantity,this.selectedOrders[_].other=this.selectedOrders[_].other+t.other,"Doors"==(null===(s=null===(o=t.work_order)||void 0===o?void 0:o.product)||void 0===s?void 0:s.name)?this.selectedOrders[_].Doors=this.selectedOrders[_].Doors+t.value:"Frame"==(null===(d=null===(a=t.work_order)||void 0===a?void 0:a.product)||void 0===d?void 0:d.name)&&(this.selectedOrders[_].Frame=this.selectedOrders[_].Frame+t.value),this.selectedOrders[_].total=this.selectedOrders[_].other+this.selectedOrders[_].delivery_fee+this.selectedOrders[_].Doors+this.selectedOrders[_].Frame,m=1,this.calculateTotal();break}0==m&&this.addToSelectedOrders(t)}else this.addToSelectedOrders(t)}isExist(t){for(let n=0;n<this.selectedOrders.length;n++)if(this.selectedOrders[n].id.find(o=>o==t.id))return!0;return!1}calculateTotal(){this.grandTotal={total:0,quantity:0,doors:0,frame:0,other:0,delivery_fee:0};for(let t=0;t<this.selectedOrders.length;t++)this.grandTotal.total=+(this.grandTotal.total+this.selectedOrders[t].total).toFixed(2),this.grandTotal.quantity=+(this.grandTotal.quantity+this.selectedOrders[t].products).toFixed(2),this.grandTotal.delivery_fee=+(this.grandTotal.delivery_fee+this.selectedOrders[t].delivery_fee).toFixed(2),this.grandTotal.doors=+(this.grandTotal.doors+this.selectedOrders[t].Doors).toFixed(2),this.grandTotal.frame=+(this.grandTotal.frame+this.selectedOrders[t].Frame).toFixed(2),this.grandTotal.other=+(this.grandTotal.other+this.selectedOrders[t].other).toFixed(2)}addToSelectedOrders(t){var n,o,s,a,d,m,_,k,q,w,U;let g={id:[t.id],work_number:[null===(n=t.work_order)||void 0===n?void 0:n.work_number],products:null===(o=t.work_order)||void 0===o?void 0:o.quantity,other:t.other,delivery_fee:0,Doors:0,Frame:0};(null===(a=null===(s=t.work_order)||void 0===s?void 0:s.quotation)||void 0===a?void 0:a.delivery_fee)&&(g.delivery_fee=null===(d=t.work_order)||void 0===d?void 0:d.quotation.delivery_fee),"Doors"==(null===(_=null===(m=t.work_order)||void 0===m?void 0:m.product)||void 0===_?void 0:_.name)?g.Doors=t.value:"Frame"==(null===(q=null===(k=t.work_order)||void 0===k?void 0:k.product)||void 0===q?void 0:q.name)&&(g.Frame=t.value),(null===(w=t.work_order)||void 0===w?void 0:w.quotation)&&(g.quotation=null===(U=t.work_order)||void 0===U?void 0:U.quotation.id),g.total=g.other+g.delivery_fee+g.Doors+g.Frame,this.selectedOrders.push(g),this.calculateTotal()}orderInputOut(){console.log("input out"),setTimeout(()=>{this.orderInput=!1,document.getElementById("add-modalId").style.minHeight="unset",this.searchSubscription&&this.searchSubscription.unsubscribe(),0==this.searchInput.nativeElement.value.length&&this.searchParams.search.length>0&&(this.searchParams.search="",this.searchSubscription=this._account.salesOrders(this.searchParams).subscribe(t=>{this.orders=t.data.data}))},200)}focusInput(){console.log("check"),document.getElementById("add-modalId").style.minHeight="50vh"}searchOrder(t){t&&(this.searchParams.search=t.target.value),this.searchSubscription&&this.searchSubscription.unsubscribe(),this.searchSubscription=this._account.salesOrders(this.searchParams).subscribe(o=>{this.orders=o.data.data})}removeOrder(t){this.grandTotal.total=+(this.grandTotal.total-this.selectedOrders[t].total).toFixed(2),this.grandTotal.quantity=+(this.grandTotal.quantity-this.selectedOrders[t].products).toFixed(2),this.grandTotal.delivery_fee=+(this.grandTotal.delivery_fee-this.selectedOrders[t].delivery_fee).toFixed(2),this.grandTotal.doors=+(this.grandTotal.doors-this.selectedOrders[t].Doors).toFixed(2),this.grandTotal.frame=+(this.grandTotal.frame-this.selectedOrders[t].Frame).toFixed(2),this.grandTotal.other=+(this.grandTotal.other-this.selectedOrders[t].other).toFixed(2),this.selectedOrders.splice(t,1)}cancel(){this.response.emit({success:!1})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(Pe.I),e.Y36(f.B),e.Y36(c.uU))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-calculate-sales-order"]],viewQuery:function(t,n){if(1&t&&e.Gf(Se,5),2&t){let o;e.iGM(o=e.CRH())&&(n.searchInput=o.first)}},outputs:{response:"response"},decls:28,vars:3,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","data-dismiss","modal",1,"close"],["id","add-modalId",1,"modal-body","add-modal"],[1,"row"],[1,"col-md-12"],[1,"input-style","mb-2"],[1,"select-box"],[1,"form-group","position-relative",3,"focusout"],[1,"d-block"],[1,"red-label"],[1,"text-danger"],["type","text","placeholder","Search work orders",1,"ctm-input","type-input",3,"input","focus"],["searchInput",""],["class","custom-dropdown-list",4,"ngIf"],["name","search",1,"input-icon"],[1,"sales-order-main-box"],[4,"ngFor","ngForOf"],["class","row",4,"ngIf"],[1,"modal-footer"],[1,"d-flex","align-items-center","justify-content-center","w-100"],["href","javascript:void(0)",1,"discard-btn",3,"click"],[1,"custom-dropdown-list"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[1,"input-style","row","d-flex","justify-content-between","m-1"],["class","red-label",4,"ngFor","ngForOf"],[1,"cross-icon"],["name","plus",1,"plus-rotate",3,"click"],[1,"search-inputs","mb-2","d-flex","justify-content-between","align-center"],[1,"input-style","px-1"],[1,"type-pass"],["type","text","placeholder","","readonly","",1,"ctm-input",3,"value"],[1,"icon-eye","d-flex","align-items-center","justify-content-center"],["src","assets/img/ipnut-pound.png","alt","pound"],[1,"input-style"],["type","number","placeholder","","readonly","",1,"ctm-input",3,"value"],["type","text","placeholder","","readonly","",1,"ctm-input","set-padding",3,"value"],[1,"d-block","text-danger"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"h4",1),e._uU(2,"CALCULATE SALES ORDER"),e.qZA(),e.TgZ(3,"button",2),e._uU(4,"\xd7"),e.qZA()(),e.TgZ(5,"div",3)(6,"div",4)(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8),e.NdJ("focusout",function(){return n.orderInputOut()}),e.TgZ(11,"label",9)(12,"span",10),e._uU(13,"Work Order Number"),e.qZA(),e.TgZ(14,"span",11),e._uU(15,"*"),e.qZA()(),e.TgZ(16,"input",12,13),e.NdJ("input",function(s){return n.searchOrder(s)})("focus",function(){return n.orderInput=!0,n.focusInput()}),e.qZA(),e.YNc(18,Je,3,1,"div",14),e._UZ(19,"i-feather",15),e.qZA()()()(),e.TgZ(20,"div",16)(21,"div",4),e.YNc(22,Ne,50,7,"ng-container",17),e.qZA()()()(),e.YNc(23,Ie,46,6,"div",18),e.TgZ(24,"div",19)(25,"div",20)(26,"a",21),e.NdJ("click",function(){return n.cancel()}),e._uU(27,"Cancel"),e.qZA()()()),2&t&&(e.xp6(18),e.Q6J("ngIf",n.orderInput),e.xp6(4),e.Q6J("ngForOf",n.selectedOrders),e.xp6(1),e.Q6J("ngIf",n.selectedOrders.length>0))},directives:[c.O5,c.sg,h.u],styles:[".add-modal[_ngcontent-%COMP%]{padding-left:20px;overflow-y:auto;overflow-x:clip;max-height:65vh;padding-right:20px!important}.cross-icon[_ngcontent-%COMP%]{background-color:#dc0100;color:#fff;border-radius:7px}.plus-rotate[_ngcontent-%COMP%]{stroke-width:1px;transform:rotate(45deg)}@media (max-width: 1370px){.add-modal[_ngcontent-%COMP%]{max-height:80vh}}"]}),i})();var N=u(2212),b=u(5860),I=u(6671),A=u(629),T=u(8601);function Ee(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"a",69),e.NdJ("click",function(){return e.CHM(t),e.oxw().addSalesOrder()}),e._UZ(1,"i-feather",70),e._uU(2," Add Sales Order "),e.qZA()}}function Ye(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"a",71),e.NdJ("click",function(){return e.CHM(t),e.oxw().addPurchaseOrder()}),e._UZ(1,"i-feather",70),e._uU(2," Add Purchase Order "),e.qZA()}}function De(i,r){1&i&&e._UZ(0,"i",72)}function Qe(i,r){1&i&&e._UZ(0,"i",73)}function je(i,r){1&i&&e._UZ(0,"i",72)}function He(i,r){1&i&&e._UZ(0,"i",73)}function Le(i,r){1&i&&e._UZ(0,"i",72)}function $e(i,r){1&i&&e._UZ(0,"i",73)}function Ve(i,r){1&i&&e._UZ(0,"i",72)}function ze(i,r){1&i&&e._UZ(0,"i",73)}function Be(i,r){1&i&&e._UZ(0,"i",72)}function We(i,r){1&i&&e._UZ(0,"i",73)}function Re(i,r){1&i&&e._UZ(0,"i",72)}function Xe(i,r){1&i&&e._UZ(0,"i",73)}const x=function(i){return["/rod/delivery-notes",i]};function Ge(i,r){if(1&i&&(e.TgZ(0,"a",92),e._uU(1,"Multiple"),e.qZA()),2&i){const t=e.oxw().$implicit;e.Q6J("routerLink",e.VKq(1,x,t.work_order.id))}}function Ke(i,r){if(1&i&&(e.TgZ(0,"a",93),e._uU(1," - "),e._UZ(2,"i-feather",94),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(2),e.Q6J("routerLink",e.VKq(1,x,t.work_order.id))}}function et(i,r){if(1&i&&(e.TgZ(0,"a",88),e._uU(1),e._UZ(2,"i-feather",95),e.qZA()),2&i){const t=e.oxw().$implicit;e.Q6J("routerLink",e.VKq(2,x,t.work_order.id)),e.xp6(1),e.hij(" ",null==t.work_order.delivery_notes[0]?null:t.work_order.delivery_notes[0].ticket_no," ")}}function tt(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"a",90),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(),s=o.$implicit,a=o.index;return e.oxw().addJobNote(s.work_order.id,a)}),e._UZ(1,"i-feather",96),e.qZA()}}function nt(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"a",97),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(),s=o.$implicit,a=o.index;return e.oxw().addJobNote(s.work_order.id,a)}),e._uU(1," View "),e.qZA()}}function it(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",98)(1,"div",99)(2,"a",100),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(),s=o.$implicit,a=o.index;return e.oxw().addJobNote(s.work_order.id,a)}),e._uU(3," Add Note "),e._UZ(4,"i-feather",101),e.qZA()(),e._UZ(5,"div",102),e.TgZ(6,"div",103),e._uU(7),e.ALo(8,"date"),e.qZA()()}if(2&i){const t=e.oxw().$implicit;e.xp6(5),e.Q6J("innerHtml",t.work_order.latest_job_note.description,e.oJD),e.xp6(2),e.hij(" ",e.xi3(8,2,t.work_order.latest_job_note.created_at,"h:mm a | dd LLLL, yyyy")," ")}}function ot(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"a",90),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(),s=o.$implicit,a=o.index;return e.oxw().editSalesOrder(s,a)}),e._UZ(1,"i-feather",104),e.qZA()}}function rt(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"a",90),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(),s=o.$implicit,a=o.index;return e.oxw().deleteOrder(s,a)}),e._UZ(1,"i-feather",105),e.qZA()}}const st=function(i,r){return{"order-withdrawn":i,"order-to-factory":r}};function at(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"tr",74)(1,"td")(2,"p",59),e._uU(3),e.qZA()(),e.TgZ(4,"td")(5,"p",59),e._uU(6),e.qZA()(),e.TgZ(7,"td")(8,"p",59),e._uU(9),e.qZA()(),e.TgZ(10,"td")(11,"p",59),e._uU(12),e.qZA()(),e.TgZ(13,"td")(14,"p",59),e._uU(15),e.qZA()(),e.TgZ(16,"td")(17,"p",59),e._uU(18),e.qZA()(),e.TgZ(19,"td")(20,"p",59),e._uU(21),e.qZA()(),e.TgZ(22,"td")(23,"p",59),e._uU(24),e.qZA()(),e.TgZ(25,"td")(26,"p",59),e._uU(27),e.qZA()(),e.TgZ(28,"td")(29,"div",75),e.YNc(30,Ge,2,3,"a",76),e.YNc(31,Ke,3,3,"a",77),e.YNc(32,et,3,4,"a",78),e.qZA()(),e.TgZ(33,"td")(34,"p",59),e._uU(35),e.ALo(36,"date"),e.qZA()(),e.TgZ(37,"td")(38,"div",79),e.YNc(39,tt,2,0,"a",80),e.YNc(40,nt,2,0,"a",81),e.YNc(41,it,9,5,"div",82),e.qZA()(),e.TgZ(42,"td")(43,"p",59),e._uU(44),e.qZA()(),e.TgZ(45,"td")(46,"div",83)(47,"label",84)(48,"input",85),e.NdJ("change",function(){const o=e.CHM(t),s=o.$implicit,a=o.index;return e.oxw().updateSaleStatus(s.id,a)}),e.qZA(),e._UZ(49,"span",86),e.qZA()()(),e.TgZ(50,"td")(51,"div",87)(52,"a",88),e._UZ(53,"i-feather",89),e.qZA(),e.TgZ(54,"a",90),e.NdJ("click",function(){const o=e.CHM(t),s=o.$implicit,a=o.index;return e.oxw().viewTimeline(s,a)}),e._UZ(55,"i-feather",91),e.qZA(),e.YNc(56,ot,2,0,"a",80),e.YNc(57,rt,2,0,"a",80),e.qZA()()()}if(2&i){const t=r.$implicit,n=e.oxw();e.Q6J("ngClass",e.WLB(26,st,t.work_order.on_hold||"Withdrawn"==t.work_order.status,"To Factory"==t.work_order.status)),e.xp6(3),e.Oqu(t.work_order.work_number),e.xp6(3),e.Oqu(t.work_order.customer.name),e.xp6(3),e.Oqu(t.work_order.quantity+" "+t.work_order.product.name),e.xp6(3),e.Oqu("Doors"==t.work_order.product.name?t.value:"0.00"),e.xp6(3),e.Oqu("Frame"==t.work_order.product.name?t.value:"0.00"),e.xp6(3),e.Oqu(null==t.work_order.quotation?null:t.work_order.quotation.delivery_fee),e.xp6(3),e.Oqu("Doors"!=t.work_order.product.name&&"Frame"!=t.work_order.product.name?t.value+t.other:0==t.other?"0.00":t.other),e.xp6(3),e.Oqu(t.work_order.on_hold?"On Hold":t.work_order.status),e.xp6(3),e.hij("",t.work_order.progress,"%"),e.xp6(3),e.Q6J("ngIf",t.work_order.delivery_notes_count>1),e.xp6(1),e.Q6J("ngIf",0==t.work_order.delivery_notes_count),e.xp6(1),e.Q6J("ngIf",1==t.work_order.delivery_notes_count),e.xp6(3),e.Oqu(e.xi3(36,23,t.month,"MMMM, YYYY")),e.xp6(4),e.Q6J("ngIf","0"==t.work_order.job_notes_count),e.xp6(1),e.Q6J("ngIf","0"!=t.work_order.job_notes_count),e.xp6(1),e.Q6J("ngIf","0"!=t.work_order.job_notes_count&&t.work_order.latest_job_note.description),e.xp6(3),e.Oqu(t.delivery_note),e.xp6(4),e.Q6J("checked",t.invoice_in_full)("disabled",!n._auth.checkPermissions("accounts","write")),e.xp6(4),e.Q6J("routerLink",e.VKq(29,x,t.work_order_id)),e.xp6(4),e.Q6J("ngIf",n._auth.checkPermissions("accounts","write")),e.xp6(1),e.Q6J("ngIf",n._auth.checkPermissions("accounts","write"))}}function ct(i,r){1&i&&e._UZ(0,"i",72)}function dt(i,r){1&i&&e._UZ(0,"i",73)}function lt(i,r){1&i&&e._UZ(0,"i",72)}function _t(i,r){1&i&&e._UZ(0,"i",73)}function ut(i,r){1&i&&e._UZ(0,"i",72)}function pt(i,r){1&i&&e._UZ(0,"i",73)}function ht(i,r){1&i&&e._UZ(0,"i",72)}function mt(i,r){1&i&&e._UZ(0,"i",73)}function gt(i,r){1&i&&e._UZ(0,"i",72)}function ft(i,r){1&i&&e._UZ(0,"i",73)}function Ct(i,r){1&i&&(e.TgZ(0,"th")(1,"p",59),e._uU(2,"Actions"),e.qZA()())}function Zt(i,r){1&i&&(e.TgZ(0,"span"),e._uU(1,",\xa0 "),e.qZA())}function vt(i,r){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.YNc(2,Zt,2,0,"span",65),e.qZA()),2&i){const t=r.$implicit,n=r.index,o=e.oxw().$implicit;e.xp6(1),e.hij(" ",null==t?null:t.work_number,""),e.xp6(1),e.Q6J("ngIf",n!=o.work_orders.length-1)}}function Tt(i,r){1&i&&(e.TgZ(0,"p",59),e._uU(1," -- "),e.qZA())}function At(i,r){if(1&i&&(e.TgZ(0,"div",79)(1,"a",113),e._uU(2," View "),e.qZA(),e.TgZ(3,"div",98),e._UZ(4,"div",102),e.TgZ(5,"div",103),e._uU(6),e.ALo(7,"date"),e.qZA()()()),2&i){const t=e.oxw().$implicit;e.xp6(4),e.Q6J("innerHtml",t.note,e.oJD),e.xp6(2),e.hij(" ",e.xi3(7,2,t.created_at,"h:mm a | dd LLLL, yyyy")," ")}}function xt(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"td")(1,"a",90),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(),s=o.$implicit,a=o.index;return e.oxw().editPurchaseOrder(s,a)}),e._UZ(2,"i-feather",104),e.qZA(),e.TgZ(3,"a",90),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(),s=o.$implicit,a=o.index;return e.oxw().deletePurchaseOrder(s,a)}),e._UZ(4,"i-feather",105),e.qZA()()}}const bt=function(i){return{disabbled:i}};function Ot(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"tr",106)(1,"td")(2,"p",59),e._uU(3),e.qZA()(),e.TgZ(4,"td")(5,"p",59),e._uU(6),e.qZA()(),e.TgZ(7,"td")(8,"p",59),e._uU(9),e.qZA()(),e.TgZ(10,"td")(11,"p",59),e.YNc(12,vt,3,2,"span",107),e.qZA(),e.YNc(13,Tt,2,0,"p",108),e.qZA(),e.TgZ(14,"td")(15,"p",59),e._uU(16),e.ALo(17,"date"),e.qZA()(),e.TgZ(18,"td")(19,"div",109)(20,"label",110)(21,"input",85),e.NdJ("change",function(){const o=e.CHM(t),s=o.$implicit,a=o.index;return e.oxw().markChecked(s,a)}),e.qZA(),e._UZ(22,"span",111),e.qZA()()(),e.TgZ(23,"td"),e.YNc(24,At,8,5,"div",112),e.qZA(),e.YNc(25,xt,5,0,"td",65),e.qZA()}if(2&i){const t=r.$implicit,n=e.oxw();e.xp6(3),e.Oqu(t.order_number),e.xp6(3),e.Oqu(t.supplier.name),e.xp6(3),e.Oqu(t.value),e.xp6(3),e.Q6J("ngForOf",t.work_orders),e.xp6(1),e.Q6J("ngIf",0==t.work_orders.length),e.xp6(3),e.Oqu(e.xi3(17,11,t.due_date,"dd-MMM-YYYY")),e.xp6(4),e.Q6J("ngClass",e.VKq(14,bt,!n._auth.checkPermissions("accounts","write"))),e.xp6(1),e.Q6J("checked",t.checked)("disabled",!n._auth.checkPermissions("accounts","write")),e.xp6(3),e.Q6J("ngIf"," "!=t.note),e.xp6(1),e.Q6J("ngIf",n._auth.checkPermissions("accounts","write"))}}function kt(i,r){1&i&&e._UZ(0,"i",72)}function qt(i,r){1&i&&e._UZ(0,"i",73)}function wt(i,r){if(1&i&&(e.TgZ(0,"tr",106)(1,"td")(2,"p",59),e._uU(3),e.qZA()(),e.TgZ(4,"td")(5,"p",59),e._uU(6),e.qZA()(),e.TgZ(7,"td")(8,"p",59),e._uU(9),e.qZA()(),e.TgZ(10,"td")(11,"p",59),e._uU(12),e.qZA()()()),2&i){const t=r.$implicit;e.xp6(3),e.Oqu(t.name),e.xp6(3),e.Oqu(t.sales.door),e.xp6(3),e.Oqu(t.sales.frame),e.xp6(3),e.Oqu(t.sales.other)}}const Ut=function(){return{isAnimated:!0,adaptivePosition:!0,dateInputFormat:"MMMM, YYYY",minMode:"month",containerClass:"theme-red"}},Pt=function(){return["/accounts/credit-check"]};let St=(()=>{class i{constructor(t,n,o,s,a,d,m){this.ref=t,this._account=n,this._modal=o,this.helper=s,this.datePipe=a,this.router=d,this._auth=m,this.customerTotals=[],this.salesOrder=[],this.purchaseOrders=[],this.dateToday=new Date,this.searchParams={search:"",page_size:10,page:1,month:"",sort_column:"work_orders.work_number",sort_value:"DESC"},this.totalPages=1,this.pageFrom=1,this.pageTo=10,this.totalCount=10,this.activeTab="salesOrder",this.firstCall=!0,this.modalConfig={animated:!0,keyboard:!1,backdrop:!1,ignoreBackdropClick:!0,size:"xl",windowClass:"modal-roles Fixed-cost-modal"},this.accountsMonth=new Date,this.searchParams.month=this.datePipe.transform(this.accountsMonth,"YYYY-MM")}ngOnInit(){this.getAccountStats(),this.getListing(),this.getNotifications()}getAccountStats(){this._account.accountStats({month:this.searchParams.month}).subscribe(t=>{this.account=t.data})}getCustomerTotalListing(){this._account.customerTotals(this.searchParams).subscribe(t=>{this.customerTotals=t.data.data,this.searchParams.page_size=t.data.per_page,this.searchParams.page=t.data.current_page,this.totalPages=t.data.last_page,this.pageFrom=t.data.from,this.pageTo=t.data.to,this.totalCount=t.data.total})}getSalesOrderListing(){this._account.salesOrders(this.searchParams).subscribe(t=>{this.salesOrder=t.data.data,this.searchParams.page_size=t.data.per_page,this.searchParams.page=t.data.current_page,this.totalPages=t.data.last_page,this.pageFrom=t.data.from,this.pageTo=t.data.to,this.totalCount=t.data.total})}getMontlyCostListing(){this._account.accountsPurchaseOrdersListing(this.searchParams).subscribe(t=>{this.purchaseOrders=t.data.data,this.searchParams.page_size=t.data.per_page,this.searchParams.page=t.data.current_page,this.totalPages=t.data.last_page,this.pageFrom=t.data.from,this.pageTo=t.data.to,this.totalCount=t.data.total})}markChecked(t,n){this._account.updatePurchaseOrderStatus({id:t.id}).subscribe(o=>{this.helper.toastSuccess(o.message),this.purchaseOrders[n]=o.data})}resetSearchParams(){this.searchParams={search:"",page_size:10,page:1,month:this.searchParams.month,sort_column:"work_orders.work_number",sort_value:"DESC"},"salesOrder"==this.activeTab?this.searchParams.sort_column="work_orders.work_number":"monthlyCost"==this.activeTab?this.searchParams.sort_column="suppliers.name":"customerTotal"==this.activeTab&&(this.searchParams.sort_column="name"),this.totalPages=1}changeTab(t){this.activeTab=t,this.resetSearchParams(),this.getListing()}getListing(){"salesOrder"==this.activeTab?this.getSalesOrderListing():"monthlyCost"==this.activeTab?this.getMontlyCostListing():"customerTotal"==this.activeTab&&this.getCustomerTotalListing()}getNotifications(){this.notificationSubscription=this.helper.currentNotification.subscribe(t=>{1==this.helper.checkNotification(this.getComponentName(),"accounts",this.getDataArray(),t)?this.checkListing():this.ref.detectChanges()})}getComponentName(){return"salesOrder"==this.activeTab?"sale-order":"monthlyCost"==this.activeTab?"purchase-cost":"customer-total"}getDataArray(){return"salesOrder"==this.activeTab?this.salesOrder:"monthlyCost"==this.activeTab?this.purchaseOrders:this.customerTotals}checkListing(){"salesOrder"==this.activeTab?this.getSalesOrderListing():"monthlyCost"==this.activeTab?this.getMontlyCostListing():"customerTotal"==this.activeTab&&this.getCustomerTotalListing()}calculateSalesOrder(){this.modalConfig.windowClass="modal-roles calculate-sale-modal Fixed-cost-modal";const t=this._modal.open(Fe,this.modalConfig);t.componentInstance.response.subscribe(n=>{this.modalConfig.size="xl",t.dismiss()})}searchOrder(){this.searchParams.page=1,this.getListing()}changePage(t){this.searchParams.page=t,this.getListing()}ChangePageSize(t){this.searchParams.page=1,this.searchParams.page_size=t,this.getListing()}addSalesOrder(){this.modalConfig.windowClass="modal-roles accounts-modal Fixed-cost-modal";const t=this._modal.open(M,this.modalConfig);t.componentInstance.type="add",t.componentInstance.response.subscribe(n=>{n.success&&(this.getAccountStats(),this.getListing()),t.dismiss()})}editSalesOrder(t,n){this.modalConfig.windowClass="modal-roles Fixed-cost-modal";const o=this._modal.open(M,this.modalConfig);o.componentInstance.type="edit",o.componentInstance.salesOrder=Object.assign({},t),o.componentInstance.response.subscribe(s=>{s.success&&(this.getAccountStats(),this.getListing()),o.dismiss()})}addPurchaseOrder(){const t=this._modal.open(y,this.modalConfig);t.componentInstance.type="add",t.componentInstance.response.subscribe(n=>{n.success&&(this.getAccountStats(),this.getListing()),t.dismiss()})}editPurchaseOrder(t,n){const o=this._modal.open(y,this.modalConfig);o.componentInstance.type="edit",o.componentInstance.salesOrder=Object.assign({},t),o.componentInstance.response.subscribe(s=>{s.success&&(this.getAccountStats(),this.getListing()),o.dismiss()})}addJobNote(t,n){this.modalConfig.windowClass="modal-roles job-notes-modal";const o=this._modal.open(N._,this.modalConfig);o.componentInstance.orderId=t,o.componentInstance.response.subscribe(s=>{s.close&&(this.getSalesOrderListing(),o.dismiss(),this.modalConfig.windowClass="modal-roles")})}updateSaleStatus(t,n){this._account.updateSaleOrderStatus({id:t}).subscribe(o=>{this.salesOrder[n]=o.data,this.helper.toastSuccess(o.message)})}monthValue(t){this.firstCall?this.firstCall=!1:(this.searchParams.month=this.datePipe.transform(t,"YYYY-MM"),this.getAccountStats(),this.getListing())}viewTimeline(t,n){console.log(t.work_order),this.modalConfig.windowClass="modal-roles timeline";const o=this._modal.open(I.z,this.modalConfig);o.componentInstance.rod=t.work_order,o.componentInstance.response.subscribe(s=>{s.success&&this.router.navigate(["/rod/delivery-notes",t.work_order_id]),o.dismiss(),this.modalConfig.windowClass="modal-roles"})}deleteOrder(t,n){const o=this._modal.open(b.p,this.modalConfig);o.componentInstance.data=t,o.componentInstance.type="accountSaleOrder",o.componentInstance.response.subscribe(s=>{s.success&&(this.getAccountStats(),this.getListing()),o.dismiss()})}deletePurchaseOrder(t,n){const o=this._modal.open(b.p,this.modalConfig);o.componentInstance.data=t,o.componentInstance.type="accountPurchaseOrder",o.componentInstance.response.subscribe(s=>{s.success&&(this.getAccountStats(),this.getListing()),o.dismiss()})}downloadData(t){if(this.searchParams.type=t,"salesOrder"==this.activeTab){if(0==this.salesOrder.length)return;this._account.downloadSalesOrder(this.searchParams).subscribe(n=>{window.open(n.data.link)})}else if("monthlyCost"==this.activeTab){if(0==this.purchaseOrders.length)return;this._account.dowloadMonthlyCost(this.searchParams).subscribe(n=>{window.open(n.data.link)})}else if("customerTotal"==this.activeTab){if(0==this.customerTotals.length)return;this._account.downloadCustomerTotal(this.searchParams).subscribe(n=>{window.open(n.data.link)})}}sortData(t){this.searchParams.sort_column=t,this.searchParams.sort_value="ASC"==this.searchParams.sort_value?"DESC":"ASC",console.log(this.searchParams),this.getListing()}ngOnDestroy(){this.notificationSubscription.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(e.sBO),e.Y36(f.B),e.Y36(v.FF),e.Y36(Z.B),e.Y36(c.uU),e.Y36(C.F0),e.Y36(A.e))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-accounts"]],decls:255,vars:86,consts:[[1,"dashboard-main","mr-30"],[1,"dashboard-content"],[1,"d-flex","align-items-center","mb-16","justify-content-between"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","javascript:void(0)",1,"breadcrumb-link"],["href","javascript:void(0)",1,"breadcrumb-link","active"],[1,"search-inputs","d-flex"],[1,"input-style","mr-10"],[1,"type-pass"],["type","text","id","start_date","placeholder","Select Month","name","start_date","bsDatepicker","",1,"ctm-input",3,"bsConfig","bsValue","bsValueChange"],[1,"icon-eye","d-flex","align-items-center","justify-content-center"],["name","calendar",1,"calender"],[1,"row"],[1,"col-md-4","col-sm-6"],["href","javascript:void(0)",1,"account-hover"],[1,"card-accounts"],[1,"sale-label-account"],[1,"account-width","d-flex","align-items-center","justify-content-between"],[1,"inner-card-box"],[1,"text-account"],[1,"doors-price-account"],[1,"col-md-3","col-sm-6"],[1,"card-accounts","card-account-orange"],[1,"card-accounts","card-account-light-green"],[1,"col-md-2","col-sm-6"],[1,"card-accounts","card-account-green"],[1,"d-flex","align-items-center","justify-content-between"],[1,"col-md-12"],[1,"roles-main","account-main-box"],[1,"d-flex","align-items-center","justify-content-between","acount-line-btn"],[1,"d-flex"],["class","Invoice","href","javascript:void(0)",3,"click",4,"ngIf"],["class","Delivery-Note","href","javascript:void(0)",3,"click",4,"ngIf"],[1,"Schedule",3,"routerLink"],[1,"Schedule","sales-order",3,"click"],[1,"search-last"],[1,"form-group","sear-bar-roles","position-relative","mb-0"],["type","search","placeholder","Search..","id","email",1,"form-control","form-control-roles",3,"ngModel","ngModelChange","input"],["name","search",1,"search-ctm"],[1,"tabs-table-account"],[1,"d-flex","tabs-account-setts","align-items-center","justify-content-between"],["role","tablist",1,"nav","nav-tabs"],[1,"nav-item"],["data-toggle","tab","href","#menu1",1,"nav-link","active",3,"click"],["data-toggle","tab","href","#menu2",1,"nav-link",3,"click"],["data-toggle","tab","href","#Customer",1,"nav-link",3,"click"],[1,"dropdown"],["type","button","id","dropdownMenuButton","data-toggle","dropdown","aria-haspopup","true","aria-expanded","false",1,"credit-check","dropdown-toggle"],["name","download",1,"download"],["aria-labelledby","dropdownMenuButton",1,"dropdown-menu","dropdown-menu-right"],[1,"dropdown-item","cursor-pointer",3,"click"],[1,"tab-content"],["id","menu1",1,"tab-pane","active"],[1,"tab-table","tab-table-account-ctm"],[1,"tables-roles-main","tables-users-main","table-responsive"],[1,"table"],[1,"thead-ctm"],[1,"cursor-pointer",3,"click"],[1,"inner-cell"],["class","fa fa-arrow-down sorting-arrow","aria-hidden","true",4,"ngIf"],["class","fa fa-arrow-up sorting-arrow","aria-hidden","true",4,"ngIf"],[1,"t-body-ctm"],["class","active-row",3,"ngClass",4,"ngFor","ngForOf"],["id","menu2",1,"tab-pane","fade"],[4,"ngIf"],["class","active-row",4,"ngFor","ngForOf"],["id","Customer",1,"tab-pane","fade"],[3,"from","to","pageSize","currentPage","totalPages","total","changePage","ChangePageSize"],["href","javascript:void(0)",1,"Invoice",3,"click"],["name","plus",1,"plus"],["href","javascript:void(0)",1,"Delivery-Note",3,"click"],["aria-hidden","true",1,"fa","fa-arrow-down","sorting-arrow"],["aria-hidden","true",1,"fa","fa-arrow-up","sorting-arrow"],[1,"active-row",3,"ngClass"],[1,"inner-cell","list-icons-talbe-sec"],["class","icon-anchor-list red",3,"routerLink",4,"ngIf"],["class","icon-anchor-list",4,"ngIf"],["class","icon-anchor-list","href","javascript:void(0)",3,"routerLink",4,"ngIf"],[1,"inner-cell","view-anchor-tooltip"],["class","icon-anchor-list","href","javascript:void(0)",3,"click",4,"ngIf"],["class","view-anchor red","href","javascript:void(0)",3,"click",4,"ngIf"],["class","tooltiptext-view",4,"ngIf"],[1,"remember-me","d-flex","justify-content-center"],[1,"custom-check","custom-check-r"],["type","checkbox",3,"checked","disabled","change"],[1,"checkmark"],[1,"inner-cell","list-icons-talbe"],["href","javascript:void(0)",1,"icon-anchor-list",3,"routerLink"],["name","book",1,"icon-width"],["href","javascript:void(0)",1,"icon-anchor-list",3,"click"],["name","trending-up",1,"icon-width"],[1,"icon-anchor-list","red",3,"routerLink"],[1,"icon-anchor-list"],["name","edit-2",1,"icon-width",3,"routerLink"],["name","edit-2",1,"icon-width"],["name","plus",1,"icon-width"],["href","javascript:void(0)",1,"view-anchor","red",3,"click"],[1,"tooltiptext-view"],[1,"d-flex","align-items-center","justify-content-end"],["href","javascript:void(0)",1,"tooltip-anchor-modal",3,"click"],["name","plus",1,"icon-width","w15"],[1,"toop-hight",3,"innerHtml"],[1,"date-tooptip-iner"],["name","edit-3",1,"icon-width"],["name","trash",1,"icon-width"],[1,"active-row"],[4,"ngFor","ngForOf"],["class","inner-cell",4,"ngIf"],[1,"custom-box"],[1,"switch",3,"ngClass"],[1,"slider","round"],["class","inner-cell view-anchor-tooltip",4,"ngIf"],["href","javascript:void(0)",1,"view-anchor","red"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"ul",3)(4,"li",4)(5,"a",5),e._uU(6,"ACCOUNTS"),e.qZA()(),e.TgZ(7,"li",4)(8,"a",6),e._uU(9),e.ALo(10,"date"),e.qZA()()(),e.TgZ(11,"div",7)(12,"div",8)(13,"div",9)(14,"input",10),e.NdJ("bsValueChange",function(s){return n.monthValue(s)}),e.qZA(),e.TgZ(15,"div",11),e._UZ(16,"i-feather",12),e.qZA()()()()()(),e.TgZ(17,"div",13)(18,"div",14)(19,"a",15)(20,"div",16)(21,"div",17),e._uU(22," sales "),e.qZA(),e.TgZ(23,"div",18)(24,"div",19)(25,"h3",20),e._uU(26,"Doors"),e.qZA(),e.TgZ(27,"p",21),e._uU(28),e.ALo(29,"currency"),e.qZA()(),e.TgZ(30,"div",19)(31,"h3",20),e._uU(32,"Frames"),e.qZA(),e.TgZ(33,"p",21),e._uU(34),e.ALo(35,"currency"),e.qZA()(),e.TgZ(36,"div",19)(37,"h3",20),e._uU(38,"Others"),e.qZA(),e.TgZ(39,"p",21),e._uU(40),e.ALo(41,"currency"),e.qZA()()()()()(),e.TgZ(42,"div",22)(43,"a",15)(44,"div",23)(45,"div",17),e._uU(46," Workload "),e.qZA(),e.TgZ(47,"div",18)(48,"div",19)(49,"h3",20),e._uU(50,"Predicted Workload"),e.qZA(),e.TgZ(51,"p",21),e._uU(52),e.ALo(53,"currency"),e.qZA()(),e.TgZ(54,"div",19)(55,"h3",20),e._uU(56,"Projected Sales"),e.qZA(),e.TgZ(57,"p",21),e._uU(58),e.ALo(59,"currency"),e.qZA()()()()()(),e.TgZ(60,"div",22)(61,"a",15)(62,"div",24)(63,"div",17),e._uU(64," In progress "),e.qZA(),e.TgZ(65,"div",18)(66,"div",19)(67,"h3",20),e._uU(68,"Work in progress"),e.qZA(),e.TgZ(69,"p",21),e._uU(70),e.ALo(71,"currency"),e.qZA()(),e.TgZ(72,"div",19)(73,"h3",20),e._uU(74,"Bought"),e.qZA(),e.TgZ(75,"p",21),e._uU(76),e.ALo(77,"currency"),e.qZA()()()()()(),e.TgZ(78,"div",25)(79,"a",15)(80,"div",26)(81,"div",17),e._uU(82," Profit "),e.qZA(),e.TgZ(83,"div",27)(84,"div",19)(85,"h3",20),e._uU(86,"Projected Profit"),e.qZA(),e.TgZ(87,"p",21),e._uU(88),e.ALo(89,"currency"),e.qZA()()()()()()()(),e.TgZ(90,"div",13)(91,"div",28)(92,"div",29)(93,"div",30)(94,"div",31),e.YNc(95,Ee,3,0,"a",32),e.YNc(96,Ye,3,0,"a",33),e.TgZ(97,"a",34),e._uU(98," Credit Check "),e.qZA(),e.TgZ(99,"a",35),e.NdJ("click",function(){return n.calculateSalesOrder()}),e._uU(100," Calculate sales order "),e.qZA()()(),e.TgZ(101,"div",36)(102,"div",37)(103,"input",38),e.NdJ("ngModelChange",function(s){return n.searchParams.search=s})("input",function(){return n.searchOrder()}),e.qZA(),e._UZ(104,"i-feather",39),e.qZA()(),e.TgZ(105,"div",40)(106,"div",41)(107,"ul",42)(108,"li",43)(109,"a",44),e.NdJ("click",function(){return n.changeTab("salesOrder")}),e._uU(110,"Sales Order"),e.qZA()(),e.TgZ(111,"li",43)(112,"a",45),e.NdJ("click",function(){return n.changeTab("monthlyCost")}),e._uU(113,"Monthly Cost"),e.qZA()(),e.TgZ(114,"li",43)(115,"a",46),e.NdJ("click",function(){return n.changeTab("customerTotal")}),e._uU(116,"Customer Totals"),e.qZA()()(),e.TgZ(117,"div",47)(118,"button",48),e._UZ(119,"i-feather",49),e._uU(120," Download Data "),e.qZA(),e.TgZ(121,"div",50)(122,"a",51),e.NdJ("click",function(){return n.downloadData("displayed")}),e._uU(123,"Displayed"),e.qZA(),e.TgZ(124,"a",51),e.NdJ("click",function(){return n.downloadData("all")}),e._uU(125,"All"),e.qZA()()()(),e.TgZ(126,"div",52)(127,"div",53)(128,"div",54)(129,"div",55)(130,"table",56)(131,"thead",57)(132,"tr")(133,"th",58),e.NdJ("click",function(){return n.sortData("work_orders.work_number")}),e.TgZ(134,"p",59),e._uU(135,"Work "),e.YNc(136,De,1,0,"i",60),e.YNc(137,Qe,1,0,"i",61),e.qZA()(),e.TgZ(138,"th",58),e.NdJ("click",function(){return n.sortData("customers.name")}),e.TgZ(139,"p",59),e._uU(140,"Customer "),e.YNc(141,je,1,0,"i",60),e.YNc(142,He,1,0,"i",61),e.qZA()(),e.TgZ(143,"th",58),e.NdJ("click",function(){return n.sortData("products.name")}),e.TgZ(144,"p",59),e._uU(145,"Product "),e.YNc(146,Le,1,0,"i",60),e.YNc(147,$e,1,0,"i",61),e.qZA()(),e.TgZ(148,"th")(149,"p",59),e._uU(150,"Door"),e.qZA()(),e.TgZ(151,"th")(152,"p",59),e._uU(153,"Frame"),e.qZA()(),e.TgZ(154,"th")(155,"p",59),e._uU(156,"Delivery Fee"),e.qZA()(),e.TgZ(157,"th")(158,"p",59),e._uU(159,"Other"),e.qZA()(),e.TgZ(160,"th",58),e.NdJ("click",function(){return n.sortData("work_orders.status")}),e.TgZ(161,"p",59),e._uU(162,"Status "),e.YNc(163,Ve,1,0,"i",60),e.YNc(164,ze,1,0,"i",61),e.qZA()(),e.TgZ(165,"th",58),e.NdJ("click",function(){return n.sortData("work_orders.progress")}),e.TgZ(166,"p",59),e._uU(167,"Progress "),e.YNc(168,Be,1,0,"i",60),e.YNc(169,We,1,0,"i",61),e.qZA()(),e.TgZ(170,"th")(171,"p",59),e._uU(172,"Delivery Note"),e.qZA()(),e.TgZ(173,"th")(174,"p",59),e._uU(175,"Month"),e.qZA()(),e.TgZ(176,"th")(177,"p",59),e._uU(178,"Notes"),e.qZA()(),e.TgZ(179,"th")(180,"p",59),e._uU(181,"Additional Notes"),e.qZA()(),e.TgZ(182,"th",58),e.NdJ("click",function(){return n.sortData("invoice_in_full")}),e.TgZ(183,"p",59),e._uU(184,"Invoiced in full "),e.YNc(185,Re,1,0,"i",60),e.YNc(186,Xe,1,0,"i",61),e.qZA()(),e.TgZ(187,"th")(188,"p",59),e._uU(189,"Actions"),e.qZA()()()(),e.TgZ(190,"tbody",62),e.YNc(191,at,58,31,"tr",63),e.qZA()()()()(),e.TgZ(192,"div",64)(193,"div",54)(194,"div",55)(195,"table",56)(196,"thead",57)(197,"tr")(198,"th",58),e.NdJ("click",function(){return n.sortData("order_number")}),e.TgZ(199,"p",59),e._uU(200,"Order Number "),e.YNc(201,ct,1,0,"i",60),e.YNc(202,dt,1,0,"i",61),e.qZA()(),e.TgZ(203,"th",58),e.NdJ("click",function(){return n.sortData("suppliers.name")}),e.TgZ(204,"p",59),e._uU(205,"Supplier "),e.YNc(206,lt,1,0,"i",60),e.YNc(207,_t,1,0,"i",61),e.qZA()(),e.TgZ(208,"th",58),e.NdJ("click",function(){return n.sortData("value")}),e.TgZ(209,"p",59),e._uU(210,"Value "),e.YNc(211,ut,1,0,"i",60),e.YNc(212,pt,1,0,"i",61),e.qZA()(),e.TgZ(213,"th",58),e.NdJ("click",function(){return n.sortData("work_number")}),e.TgZ(214,"p",59),e._uU(215,"Work# "),e.YNc(216,ht,1,0,"i",60),e.YNc(217,mt,1,0,"i",61),e.qZA()(),e.TgZ(218,"th")(219,"p",59),e._uU(220,"Date"),e.qZA()(),e.TgZ(221,"th",58),e.NdJ("click",function(){return n.sortData("checked")}),e.TgZ(222,"p",59),e._uU(223,"Checked "),e.YNc(224,gt,1,0,"i",60),e.YNc(225,ft,1,0,"i",61),e.qZA()(),e.TgZ(226,"th")(227,"p",59),e._uU(228,"Comments"),e.qZA()(),e.YNc(229,Ct,3,0,"th",65),e.qZA()(),e.TgZ(230,"tbody",62),e.YNc(231,Ot,26,16,"tr",66),e.qZA()()()()(),e.TgZ(232,"div",67)(233,"div",54)(234,"div",55)(235,"table",56)(236,"thead",57)(237,"tr")(238,"th",58),e.NdJ("click",function(){return n.sortData("name")}),e.TgZ(239,"p",59),e._uU(240,"Customer "),e.YNc(241,kt,1,0,"i",60),e.YNc(242,qt,1,0,"i",61),e.qZA()(),e.TgZ(243,"th")(244,"p",59),e._uU(245,"Total Doors"),e.qZA()(),e.TgZ(246,"th")(247,"p",59),e._uU(248,"Total Frames"),e.qZA()(),e.TgZ(249,"th")(250,"p",59),e._uU(251,"Total Other"),e.qZA()()()(),e.TgZ(252,"tbody",62),e.YNc(253,wt,13,4,"tr",66),e.qZA()()()()(),e.TgZ(254,"app-pagination",68),e.NdJ("changePage",function(s){return n.changePage(s)})("ChangePageSize",function(s){return n.ChangePageSize(s)}),e.qZA()()()()()()),2&t&&(e.xp6(9),e.hij("Week ",e.xi3(10,49,n.dateToday,"ww"),""),e.xp6(5),e.Q6J("bsConfig",e.DdM(84,Ut))("bsValue",n.accountsMonth),e.xp6(14),e.Oqu(e.Dn7(29,52,null==n.account?null:n.account.sales.door,"GBP","symbol")),e.xp6(6),e.Oqu(e.Dn7(35,56,null==n.account?null:n.account.sales.frame,"GBP","symbol")),e.xp6(6),e.Oqu(e.Dn7(41,60,null==n.account?null:n.account.sales.other,"GBP","symbol")),e.xp6(12),e.Oqu(e.Dn7(53,64,null==n.account?null:n.account.workload.predicted_workload,"GBP","symbol")),e.xp6(6),e.Oqu(e.Dn7(59,68,null==n.account?null:n.account.workload.projected_sales,"GBP","symbol")),e.xp6(12),e.Oqu(e.Dn7(71,72,null==n.account?null:n.account.in_progress.work_in_progress,"GBP","symbol")),e.xp6(6),e.Oqu(e.Dn7(77,76,null==n.account?null:n.account.in_progress.bought,"GBP","symbol")),e.xp6(12),e.Oqu(e.Dn7(89,80,null==n.account?null:n.account.profit.projected_profit,"GBP","symbol")),e.xp6(7),e.Q6J("ngIf",n._auth.checkPermissions("accounts","write")),e.xp6(1),e.Q6J("ngIf",n._auth.checkPermissions("accounts","write")),e.xp6(1),e.Q6J("routerLink",e.DdM(85,Pt)),e.xp6(6),e.Q6J("ngModel",n.searchParams.search),e.xp6(33),e.Q6J("ngIf","work_orders.work_number"==n.searchParams.sort_column&&"DESC"==n.searchParams.sort_value),e.xp6(1),e.Q6J("ngIf","work_orders.work_number"==n.searchParams.sort_column&&"ASC"==n.searchParams.sort_value),e.xp6(4),e.Q6J("ngIf","customers.name"==n.searchParams.sort_column&&"DESC"==n.searchParams.sort_value),e.xp6(1),e.Q6J("ngIf","customers.name"==n.searchParams.sort_column&&"ASC"==n.searchParams.sort_value),e.xp6(4),e.Q6J("ngIf","products.name"==n.searchParams.sort_column&&"DESC"==n.searchParams.sort_value),e.xp6(1),e.Q6J("ngIf","products.name"==n.searchParams.sort_column&&"ASC"==n.searchParams.sort_value),e.xp6(16),e.Q6J("ngIf","work_orders.status"==n.searchParams.sort_column&&"DESC"==n.searchParams.sort_value),e.xp6(1),e.Q6J("ngIf","work_orders.status"==n.searchParams.sort_column&&"ASC"==n.searchParams.sort_value),e.xp6(4),e.Q6J("ngIf","work_orders.progress"==n.searchParams.sort_column&&"DESC"==n.searchParams.sort_value),e.xp6(1),e.Q6J("ngIf","work_orders.progress"==n.searchParams.sort_column&&"ASC"==n.searchParams.sort_value),e.xp6(16),e.Q6J("ngIf","invoice_in_full"==n.searchParams.sort_column&&"DESC"==n.searchParams.sort_value),e.xp6(1),e.Q6J("ngIf","invoice_in_full"==n.searchParams.sort_column&&"ASC"==n.searchParams.sort_value),e.xp6(5),e.Q6J("ngForOf",n.salesOrder),e.xp6(10),e.Q6J("ngIf","order_number"==n.searchParams.sort_column&&"DESC"==n.searchParams.sort_value),e.xp6(1),e.Q6J("ngIf","order_number"==n.searchParams.sort_column&&"ASC"==n.searchParams.sort_value),e.xp6(4),e.Q6J("ngIf","suppliers.name"==n.searchParams.sort_column&&"DESC"==n.searchParams.sort_value),e.xp6(1),e.Q6J("ngIf","suppliers.name"==n.searchParams.sort_column&&"ASC"==n.searchParams.sort_value),e.xp6(4),e.Q6J("ngIf","value"==n.searchParams.sort_column&&"DESC"==n.searchParams.sort_value),e.xp6(1),e.Q6J("ngIf","value"==n.searchParams.sort_column&&"ASC"==n.searchParams.sort_value),e.xp6(4),e.Q6J("ngIf","work_number"==n.searchParams.sort_column&&"DESC"==n.searchParams.sort_value),e.xp6(1),e.Q6J("ngIf","work_number"==n.searchParams.sort_column&&"ASC"==n.searchParams.sort_value),e.xp6(7),e.Q6J("ngIf","checked"==n.searchParams.sort_column&&"DESC"==n.searchParams.sort_value),e.xp6(1),e.Q6J("ngIf","checked"==n.searchParams.sort_column&&"ASC"==n.searchParams.sort_value),e.xp6(4),e.Q6J("ngIf",n._auth.checkPermissions("accounts","write")),e.xp6(2),e.Q6J("ngForOf",n.purchaseOrders),e.xp6(10),e.Q6J("ngIf","name"==n.searchParams.sort_column&&"DESC"==n.searchParams.sort_value),e.xp6(1),e.Q6J("ngIf","name"==n.searchParams.sort_column&&"ASC"==n.searchParams.sort_value),e.xp6(11),e.Q6J("ngForOf",n.customerTotals),e.xp6(1),e.Q6J("from",n.pageFrom)("to",n.pageTo)("pageSize",n.searchParams.page_size)("currentPage",n.searchParams.page)("totalPages",n.totalPages)("total",n.totalCount))},directives:[p.Y5,p.Np,h.u,c.O5,C.yS,l.Fj,l.JJ,l.On,c.sg,c.mk,C.rH,T.Q],pipes:[c.uU,c.H9],styles:["a.icon-anchor-list.red[_ngcontent-%COMP%], a.view-anchor.red[_ngcontent-%COMP%]{color:#dc0100!important}.sales-order[_ngcontent-%COMP%]{background-color:#ff9f3e;color:#fff}.sales-order[_ngcontent-%COMP%]:hover{background-color:#dc0100;color:#fff;cursor:pointer}"]}),i})();function yt(i,r){if(1&i&&(e.TgZ(0,"tr")(1,"td",8),e._uU(2),e.qZA(),e.TgZ(3,"td",8),e._uU(4),e.qZA(),e.TgZ(5,"td",8),e._uU(6),e.qZA()()),2&i){const t=r.$implicit;e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Oqu(t.workNumber),e.xp6(2),e.hij("\xa3",t.value,"")}}let Jt=(()=>{class i{constructor(){this.credits=[],this.response=new e.vpe,this.total=0,this.totals=[]}ngOnInit(){this.calculateTotal()}calculateTotal(){this.credits.forEach(t=>{t.checked&&(this.total+=Number(t.sale_order.value),this.totals.find(n=>n.name==t.customer.name)?(this.totals[this.totals.indexOf(this.totals.find(n=>n.name==t.customer.name))].value+=Number(t.sale_order.value),this.totals[this.totals.indexOf(this.totals.find(n=>n.name==t.customer.name))].workNumber+=", "+t.work_number):this.totals.push({name:t.customer.name,value:Number(t.sale_order.value),workNumber:t.work_number}))}),this.totals.forEach(t=>{t.value=+t.value.toFixed(2)})}close(){this.response.emit({success:!0})}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-view-credit-check-details"]],inputs:{credits:"credits"},outputs:{response:"response"},decls:30,vars:5,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","data-dismiss","modal",1,"close"],[1,"modal-body"],[1,"row"],[1,"col-md-12"],[1,"modal-table","table-responsive"],[1,"table","credit-check-table"],[2,"width","33.33%"],[4,"ngFor","ngForOf"],[1,"d-flex","grand-total","w-100","justify-content-between"],[1,"left-total"],[1,"right-total"],[1,"modal-footer"],[1,"d-flex","align-items-center","justify-content-center","w-100"],["href","javascript:void(0) ",1,"add-btn",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"h4",1),e._uU(2,"CREDIT CHECK"),e.qZA(),e.TgZ(3,"button",2),e._uU(4,"\xd7"),e.qZA()(),e.TgZ(5,"div",3)(6,"div",4)(7,"div",5)(8,"div",6)(9,"table",7)(10,"thead")(11,"tr")(12,"th",8),e._uU(13,"Name:"),e.qZA(),e.TgZ(14,"th",8),e._uU(15,"Work#"),e.qZA(),e.TgZ(16,"th",8),e._uU(17,"Total"),e.qZA()()(),e.TgZ(18,"tbody"),e.YNc(19,yt,7,3,"tr",9),e.qZA()()(),e.TgZ(20,"div",10)(21,"p",11),e._uU(22,"Grand Total"),e.qZA(),e.TgZ(23,"p",12),e._uU(24),e.ALo(25,"number"),e.qZA()()()()(),e.TgZ(26,"div",13)(27,"div",14)(28,"a",15),e.NdJ("click",function(){return n.close()}),e._uU(29,"Close"),e.qZA()()()),2&t&&(e.xp6(19),e.Q6J("ngForOf",n.totals),e.xp6(5),e.hij("\xa3",e.xi3(25,2,n.total,"1.0-2"),""))},directives:[c.sg],pipes:[c.JJ],styles:[".grand-total[_ngcontent-%COMP%]{width:76%}.credit-check-table[_ngcontent-%COMP%]{margin:4rem 0px 6rem!important;width:100%!important}.credit-check-table[_ngcontent-%COMP%] > thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child, .credit-check-table[_ngcontent-%COMP%] > tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{text-align:left!important}.credit-check-table[_ngcontent-%COMP%] > thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child, .credit-check-table[_ngcontent-%COMP%] > tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{text-align:right!important}"]}),i})();function Mt(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"a",29),e.NdJ("click",function(){return e.CHM(t),e.oxw().creditCheck()}),e._uU(1," Credit Check "),e.qZA()}}function Nt(i,r){1&i&&e._UZ(0,"i",30)}function It(i,r){1&i&&e._UZ(0,"i",31)}function Ft(i,r){1&i&&e._UZ(0,"i",30)}function Et(i,r){1&i&&e._UZ(0,"i",31)}function Yt(i,r){1&i&&e._UZ(0,"i",30)}function Dt(i,r){1&i&&e._UZ(0,"i",31)}function Qt(i,r){1&i&&e._UZ(0,"i",30)}function jt(i,r){1&i&&e._UZ(0,"i",31)}function Ht(i,r){1&i&&e._UZ(0,"i",30)}function Lt(i,r){1&i&&e._UZ(0,"i",31)}function $t(i,r){1&i&&e._UZ(0,"i",30)}function Vt(i,r){1&i&&e._UZ(0,"i",31)}const zt=function(i,r){return{"order-withdrawn":i,"order-to-factory":r}};function Bt(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"tr",32)(1,"td")(2,"div",18)(3,"label",19)(4,"input",33),e.NdJ("ngModelChange",function(o){return e.CHM(t).$implicit.checked=o})("change",function(){return e.CHM(t),e.oxw().selectOptions()}),e.qZA(),e._UZ(5,"span",21),e.qZA()()(),e.TgZ(6,"td")(7,"p",23),e._uU(8),e.qZA()(),e.TgZ(9,"td")(10,"p",23),e._uU(11),e.qZA()(),e.TgZ(12,"td")(13,"p",23),e._uU(14),e.qZA()(),e.TgZ(15,"td")(16,"p",23),e._uU(17),e.qZA()(),e.TgZ(18,"td")(19,"p",23),e._uU(20),e.qZA()(),e.TgZ(21,"td")(22,"p",23),e._uU(23),e.qZA()()()}if(2&i){const t=r.$implicit;e.Q6J("ngClass",e.WLB(8,zt,t.on_hold||"Withdrawn"==t.status,"To Factory"==t.status)),e.xp6(4),e.Q6J("ngModel",t.checked),e.xp6(4),e.Oqu(t.week_number),e.xp6(3),e.Oqu(t.work_number),e.xp6(3),e.Oqu(t.customer.name),e.xp6(3),e.Oqu(t.product.name),e.xp6(3),e.Oqu(t.on_hold?"On Hold":t.status),e.xp6(3),e.hij("",t.progress,"%")}}let Wt=(()=>{class i{constructor(t,n,o,s){this.ref=t,this._account=n,this._modal=o,this.helper=s,this.creditChecks=[],this.dateToday=new Date,this.modalConfig={animated:!0,keyboard:!1,backdrop:!1,ignoreBackdropClick:!0,windowClass:"modal-roles Fixed-cost-modal"},this.searchParams={search:"",page_size:10,page:1,sort_column:"due_date",sort_value:"DESC"},this.totalPages=1,this.pageFrom=1,this.pageTo=10,this.totalCount=10,this.checked=!1,this.checkAll=!1}ngOnInit(){this.getCreditChecks(),this.getNotifications()}getNotifications(){this.notificationSubscription=this.helper.currentNotification.subscribe(t=>{1==this.helper.checkNotification("credit-check","accounts",this.creditChecks,t)?this.getCreditChecks():this.ref.detectChanges()})}getCreditChecks(){this._account.creditCheckListing(this.searchParams).subscribe(t=>{this.creditChecks=t.data.data.map(n=>(n.checked=!1,n)),this.searchParams.page_size=t.data.per_page,this.searchParams.page=t.data.current_page,this.totalPages=t.data.last_page,this.pageFrom=t.data.from,this.pageTo=t.data.to,this.totalCount=t.data.total})}search(){this.searchParams.page=1,this.getCreditChecks()}selectOptions(){console.log(this.creditChecks),this.checked=!!this.creditChecks.find(t=>t.checked),this.checkAll=!this.creditChecks.find(t=>!t.checked)}selectAll(){this.creditChecks.map(this.checkAll?t=>t.checked=!0:t=>t.checked=!1),this.checkAll=!this.creditChecks.find(t=>!t.checked),this.selectOptions()}creditCheck(){console.log(this.creditChecks),this.modalConfig.windowClass="modal-roles change-status-modal credit-modal";const t=this._modal.open(Jt,this.modalConfig);t.componentInstance.credits=this.creditChecks,t.componentInstance.response.subscribe(n=>{t.dismiss()})}changePage(t){this.searchParams.page=t,this.getCreditChecks()}ChangePageSize(t){this.searchParams.page=1,this.searchParams.page_size=t,this.getCreditChecks()}sortData(t){this.searchParams.sort_column=t,this.searchParams.sort_value="ASC"==this.searchParams.sort_value?"DESC":"ASC",this.getCreditChecks()}ngOnDestroy(){this.notificationSubscription.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(e.sBO),e.Y36(f.B),e.Y36(v.FF),e.Y36(Z.B))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-credit-check"]],decls:64,vars:27,consts:[[1,"dashboard-main"],[1,"dashboard-content"],[1,"d-flex","align-items-center","mb-16","justify-content-between","mr-70"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","javascript:void(0)",1,"breadcrumb-link"],["href","javascript:void(0)",1,"breadcrumb-link","active"],[1,"roles-main","delivery-list-table"],[1,"d-flex","align-items-center","justify-content-between","delivery-list-main","fixed-cost-bar"],[1,"d-flex","for-media-setts","justify-content-between"],[1,"form-group","sear-bar-roles","position-relative","mb-0"],["type","search","placeholder","Search..","id","email",1,"form-control","form-control-roles",3,"ngModel","ngModelChange","input"],["name","search",1,"search-ctm"],["class","secondary-sup","href","javascript:void(0)",3,"click",4,"ngIf"],[1,"tab-table"],[1,"tables-roles-main","tables-users-main","table-responsive"],[1,"table"],[1,"thead-ctm"],[1,"remember-me"],[1,"custom-check","custom-check-r"],["type","checkbox",3,"checked","ngModel","ngModelChange","change"],[1,"checkmark"],[1,"cursor-pointer",3,"click"],[1,"inner-cell"],["class","fa fa-arrow-down sorting-arrow","aria-hidden","true",4,"ngIf"],["class","fa fa-arrow-up sorting-arrow","aria-hidden","true",4,"ngIf"],[1,"t-body-ctm"],["class","active-row",3,"ngClass",4,"ngFor","ngForOf"],[3,"from","to","pageSize","currentPage","totalPages","total","changePage","ChangePageSize"],["href","javascript:void(0)",1,"secondary-sup",3,"click"],["aria-hidden","true",1,"fa","fa-arrow-down","sorting-arrow"],["aria-hidden","true",1,"fa","fa-arrow-up","sorting-arrow"],[1,"active-row",3,"ngClass"],["type","checkbox",3,"ngModel","ngModelChange","change"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"ul",3)(4,"li",4)(5,"a",5),e._uU(6,"ACCOUNTS"),e.qZA()(),e.TgZ(7,"li",4)(8,"a",5),e._uU(9,"CREDIT CHECK"),e.qZA()(),e.TgZ(10,"li",4)(11,"a",6),e._uU(12),e.ALo(13,"date"),e.qZA()()()(),e.TgZ(14,"div",7)(15,"div",8)(16,"div",9)(17,"div",10)(18,"input",11),e.NdJ("ngModelChange",function(s){return n.searchParams.search=s})("input",function(){return n.search()}),e.qZA(),e._UZ(19,"i-feather",12),e.qZA()(),e.YNc(20,Mt,2,0,"a",13),e.qZA(),e.TgZ(21,"div",14)(22,"div",15)(23,"table",16)(24,"thead",17)(25,"tr")(26,"th")(27,"div",18)(28,"label",19)(29,"input",20),e.NdJ("ngModelChange",function(s){return n.checkAll=s})("change",function(){return n.selectAll()}),e.qZA(),e._UZ(30,"span",21),e.qZA()()(),e.TgZ(31,"th",22),e.NdJ("click",function(){return n.sortData("due_date")}),e.TgZ(32,"p",23),e._uU(33,"W/C "),e.YNc(34,Nt,1,0,"i",24),e.YNc(35,It,1,0,"i",25),e.qZA()(),e.TgZ(36,"th",22),e.NdJ("click",function(){return n.sortData("work_number")}),e.TgZ(37,"p",23),e._uU(38,"Work# "),e.YNc(39,Ft,1,0,"i",24),e.YNc(40,Et,1,0,"i",25),e.qZA()(),e.TgZ(41,"th",22),e.NdJ("click",function(){return n.sortData("customers.name")}),e.TgZ(42,"p",23),e._uU(43,"Customer "),e.YNc(44,Yt,1,0,"i",24),e.YNc(45,Dt,1,0,"i",25),e.qZA()(),e.TgZ(46,"th",22),e.NdJ("click",function(){return n.sortData("products.name")}),e.TgZ(47,"p",23),e._uU(48,"Product "),e.YNc(49,Qt,1,0,"i",24),e.YNc(50,jt,1,0,"i",25),e.qZA()(),e.TgZ(51,"th",22),e.NdJ("click",function(){return n.sortData("status")}),e.TgZ(52,"p",23),e._uU(53,"Status "),e.YNc(54,Ht,1,0,"i",24),e.YNc(55,Lt,1,0,"i",25),e.qZA()(),e.TgZ(56,"th",22),e.NdJ("click",function(){return n.sortData("progress")}),e.TgZ(57,"p",23),e._uU(58,"Progress "),e.YNc(59,$t,1,0,"i",24),e.YNc(60,Vt,1,0,"i",25),e.qZA()()()(),e.TgZ(61,"tbody",26),e.YNc(62,Bt,24,11,"tr",27),e.qZA()()(),e.TgZ(63,"app-pagination",28),e.NdJ("changePage",function(s){return n.changePage(s)})("ChangePageSize",function(s){return n.ChangePageSize(s)}),e.qZA()()()()()),2&t&&(e.xp6(12),e.hij("Week ",e.xi3(13,24,n.dateToday,"ww"),""),e.xp6(6),e.Q6J("ngModel",n.searchParams.search),e.xp6(2),e.Q6J("ngIf",n.checked),e.xp6(9),e.Q6J("checked",n.checkAll)("ngModel",n.checkAll),e.xp6(5),e.Q6J("ngIf","due_date"==n.searchParams.sort_column&&"DESC"==n.searchParams.sort_value),e.xp6(1),e.Q6J("ngIf","due_date"==n.searchParams.sort_column&&"ASC"==n.searchParams.sort_value),e.xp6(4),e.Q6J("ngIf","work_number"==n.searchParams.sort_column&&"DESC"==n.searchParams.sort_value),e.xp6(1),e.Q6J("ngIf","work_number"==n.searchParams.sort_column&&"ASC"==n.searchParams.sort_value),e.xp6(4),e.Q6J("ngIf","customers.name"==n.searchParams.sort_column&&"DESC"==n.searchParams.sort_value),e.xp6(1),e.Q6J("ngIf","customers.name"==n.searchParams.sort_column&&"ASC"==n.searchParams.sort_value),e.xp6(4),e.Q6J("ngIf","products.name"==n.searchParams.sort_column&&"DESC"==n.searchParams.sort_value),e.xp6(1),e.Q6J("ngIf","products.name"==n.searchParams.sort_column&&"ASC"==n.searchParams.sort_value),e.xp6(4),e.Q6J("ngIf","status"==n.searchParams.sort_column&&"DESC"==n.searchParams.sort_value),e.xp6(1),e.Q6J("ngIf","status"==n.searchParams.sort_column&&"ASC"==n.searchParams.sort_value),e.xp6(4),e.Q6J("ngIf","progress"==n.searchParams.sort_column&&"DESC"==n.searchParams.sort_value),e.xp6(1),e.Q6J("ngIf","progress"==n.searchParams.sort_column&&"ASC"==n.searchParams.sort_value),e.xp6(2),e.Q6J("ngForOf",n.creditChecks),e.xp6(1),e.Q6J("from",n.pageFrom)("to",n.pageTo)("pageSize",n.searchParams.page_size)("currentPage",n.searchParams.page)("totalPages",n.totalPages)("total",n.totalCount))},directives:[l.Fj,l.JJ,l.On,h.u,c.O5,l.Wl,c.sg,c.mk,T.Q],pipes:[c.uU],styles:[".delivery-list-main.fixed-cost-bar[_ngcontent-%COMP%]{width:99%}"]}),i})();var Rt=u(2027);function Xt(i,r){1&i&&(e.TgZ(0,"h4",9),e._uU(1,"ADD FIXED COST"),e.qZA())}function Gt(i,r){1&i&&(e.TgZ(0,"h4",9),e._uU(1,"EDIT FIXED COST"),e.qZA())}function Kt(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"li",42),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw(3).selectSupplier(s)}),e.TgZ(1,"strong"),e._uU(2),e.qZA()()}if(2&i){const t=r.$implicit;e.xp6(2),e.Oqu(t.name)}}function en(i,r){if(1&i&&(e.TgZ(0,"div",40)(1,"ul"),e.YNc(2,Kt,3,1,"li",41),e.qZA()()),2&i){const t=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",t.suppliers)}}function tn(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"span",43),e._uU(1),e.TgZ(2,"span")(3,"i-feather",44),e.NdJ("click",function(){const s=e.CHM(t).index;return e.oxw(2).removeDate(s)}),e.qZA()()()}if(2&i){const t=r.$implicit;e.xp6(1),e.hij(" ",t," ")}}function nn(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",10)(1,"div",11)(2,"div",12)(3,"label",13)(4,"span",14),e._uU(5,"Value"),e.qZA(),e.TgZ(6,"span",15),e._uU(7,"*"),e.qZA()(),e.TgZ(8,"input",16),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().newFixedCost.value=o}),e.qZA()()(),e.TgZ(9,"div",11)(10,"div",12)(11,"label",13)(12,"span",14),e._uU(13,"Order Number"),e.qZA(),e.TgZ(14,"span",15),e._uU(15,"*"),e.qZA()(),e.TgZ(16,"input",17),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().newFixedCost.order_number=o}),e.qZA()()(),e.TgZ(17,"div",11)(18,"div",12)(19,"div",18)(20,"div",19),e.NdJ("focusout",function(){return e.CHM(t),e.oxw().supplierInputOut()}),e.TgZ(21,"label",13)(22,"span",14),e._uU(23,"Supplier"),e.qZA(),e.TgZ(24,"span",15),e._uU(25,"*"),e.qZA()(),e.TgZ(26,"input",20),e.NdJ("input",function(o){return e.CHM(t),e.oxw().getSuppliers(o)})("focus",function(){return e.CHM(t),e.oxw().supplierInput=!0})("ngModelChange",function(o){return e.CHM(t),e.oxw().selectedSupplier=o}),e.qZA(),e.YNc(27,en,3,1,"div",21),e._UZ(28,"i-feather",22),e.qZA()()()(),e.TgZ(29,"div",11)(30,"div",12)(31,"div",18)(32,"div",23)(33,"label",13)(34,"span",14),e._uU(35,"Dates"),e.qZA(),e.TgZ(36,"span",15),e._uU(37,"*"),e.qZA()(),e.TgZ(38,"select",24),e.NdJ("change",function(o){return e.CHM(t),e.oxw().selectMonth(o)}),e.TgZ(39,"option",25),e._uU(40,"Select Months"),e.qZA(),e.TgZ(41,"option",26),e._uU(42,"January"),e.qZA(),e.TgZ(43,"option",27),e._uU(44,"February"),e.qZA(),e.TgZ(45,"option",28),e._uU(46,"March"),e.qZA(),e.TgZ(47,"option",29),e._uU(48,"April"),e.qZA(),e.TgZ(49,"option",30),e._uU(50,"May"),e.qZA(),e.TgZ(51,"option",31),e._uU(52,"June"),e.qZA(),e.TgZ(53,"option",32),e._uU(54,"July"),e.qZA(),e.TgZ(55,"option",33),e._uU(56,"August"),e.qZA(),e.TgZ(57,"option",34),e._uU(58,"September"),e.qZA(),e.TgZ(59,"option",35),e._uU(60,"October"),e.qZA(),e.TgZ(61,"option",36),e._uU(62,"November"),e.qZA(),e.TgZ(63,"option",37),e._uU(64,"December"),e.qZA()(),e.TgZ(65,"div",38),e.YNc(66,tn,4,1,"span",39),e.qZA()()()()()()}if(2&i){const t=e.oxw();e.xp6(8),e.Q6J("ngModel",t.newFixedCost.value),e.xp6(8),e.Q6J("ngModel",t.newFixedCost.order_number),e.xp6(10),e.Q6J("ngModel",t.selectedSupplier),e.xp6(1),e.Q6J("ngIf",t.supplierInput),e.xp6(39),e.Q6J("ngForOf",t.newFixedCost.cost_dates)}}function on(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"li",42),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw(3).selectSupplier(s)}),e.TgZ(1,"strong"),e._uU(2),e.qZA()()}if(2&i){const t=r.$implicit;e.xp6(2),e.Oqu(t.name)}}function rn(i,r){if(1&i&&(e.TgZ(0,"div",40)(1,"ul"),e.YNc(2,on,3,1,"li",41),e.qZA()()),2&i){const t=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",t.suppliers)}}function sn(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"span",43),e._uU(1),e.TgZ(2,"span")(3,"i-feather",44),e.NdJ("click",function(){const s=e.CHM(t).index;return e.oxw(2).removeDate(s)}),e.qZA()()()}if(2&i){const t=r.$implicit;e.xp6(1),e.hij(" ",t," ")}}function an(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",10)(1,"div",11)(2,"div",12)(3,"label",13)(4,"span",14),e._uU(5,"Value"),e.qZA(),e.TgZ(6,"span",15),e._uU(7,"*"),e.qZA()(),e.TgZ(8,"input",16),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().fixedCost.value=o}),e.qZA()()(),e.TgZ(9,"div",11)(10,"div",12)(11,"label",13)(12,"span",14),e._uU(13,"Order Number"),e.qZA(),e.TgZ(14,"span",15),e._uU(15,"*"),e.qZA()(),e.TgZ(16,"input",45),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().fixedCost.order_number=o}),e.qZA()()(),e.TgZ(17,"div",11)(18,"div",12)(19,"div",18)(20,"div",19),e.NdJ("focusout",function(){return e.CHM(t),e.oxw().supplierInputOut()}),e.TgZ(21,"label",13)(22,"span",14),e._uU(23,"Supplier"),e.qZA(),e.TgZ(24,"span",15),e._uU(25,"*"),e.qZA()(),e.TgZ(26,"input",20),e.NdJ("input",function(o){return e.CHM(t),e.oxw().getSuppliers(o)})("focus",function(){return e.CHM(t),e.oxw().supplierInput=!0})("ngModelChange",function(o){return e.CHM(t),e.oxw().selectedSupplier=o}),e.qZA(),e.YNc(27,rn,3,1,"div",21),e._UZ(28,"i-feather",22),e.qZA()()()(),e.TgZ(29,"div",11)(30,"div",12)(31,"div",18)(32,"div",23)(33,"label",13)(34,"span",14),e._uU(35,"Dates"),e.qZA(),e.TgZ(36,"span",15),e._uU(37,"*"),e.qZA()(),e.TgZ(38,"select",24),e.NdJ("change",function(o){return e.CHM(t),e.oxw().selectMonth(o)}),e.TgZ(39,"option",25),e._uU(40,"Select Months"),e.qZA(),e.TgZ(41,"option",26),e._uU(42,"January"),e.qZA(),e.TgZ(43,"option",27),e._uU(44,"February"),e.qZA(),e.TgZ(45,"option",28),e._uU(46,"March"),e.qZA(),e.TgZ(47,"option",29),e._uU(48,"April"),e.qZA(),e.TgZ(49,"option",30),e._uU(50,"May"),e.qZA(),e.TgZ(51,"option",31),e._uU(52,"June"),e.qZA(),e.TgZ(53,"option",32),e._uU(54,"July"),e.qZA(),e.TgZ(55,"option",33),e._uU(56,"August"),e.qZA(),e.TgZ(57,"option",34),e._uU(58,"September"),e.qZA(),e.TgZ(59,"option",35),e._uU(60,"October"),e.qZA(),e.TgZ(61,"option",36),e._uU(62,"November"),e.qZA(),e.TgZ(63,"option",37),e._uU(64,"December"),e.qZA()(),e.TgZ(65,"div",38),e.YNc(66,sn,4,1,"span",39),e.qZA()()()()()()}if(2&i){const t=e.oxw();e.xp6(8),e.Q6J("ngModel",t.fixedCost.value),e.xp6(8),e.Q6J("ngModel",t.fixedCost.order_number),e.xp6(10),e.Q6J("ngModel",t.selectedSupplier),e.xp6(1),e.Q6J("ngIf",t.supplierInput),e.xp6(39),e.Q6J("ngForOf",t.fixedCost.cost_dates)}}function cn(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"a",46),e.NdJ("click",function(){return e.CHM(t),e.oxw().addFixedCost()}),e._uU(1,"Add"),e.qZA()}}function dn(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"a",46),e.NdJ("click",function(){return e.CHM(t),e.oxw().udpateFixedCost()}),e._uU(1,"Update"),e.qZA()}}let F=(()=>{class i{constructor(t,n,o){this._phonebook=t,this._account=n,this.helper=o,this.response=new e.vpe,this.type="add",this.newFixedCost={value:0,supplier_id:0,frequency:null,cost_dates:[],order_number:""},this.suppliers=[],this.supplierInput=!1,this.selectedSupplier=""}ngOnInit(){this.getSuppliers(),this.selectedSupplier=this.fixedCost.supplier.name}getSuppliers(t=null){let n="";t&&(n=t.target.value),(n.length>=3||0==n.length)&&(this.searchSubscription&&this.searchSubscription.unsubscribe(),this._account.supplierListing({search:n}).subscribe(o=>{var s;this.suppliers=o.data.data,this.newFixedCost.supplier_id=null===(s=o.data.data[0])||void 0===s?void 0:s.id}))}selectMonth(t){if("edit"==this.type){if(this.fixedCost.cost_dates.includes(t.target.value))return void(t.target.value=null);this.fixedCost.cost_dates.push(t.target.value),t.target.value=null}else{if(this.newFixedCost.cost_dates.includes(t.target.value))return void(t.target.value=null);this.newFixedCost.cost_dates.push(t.target.value),t.target.value=null}}removeDate(t){"add"==this.type?this.newFixedCost.cost_dates.splice(t,1):this.fixedCost.cost_dates.splice(t,1)}cancel(){this.response.emit({success:!1})}addFixedCost(){console.log(this.newFixedCost),this._account.addFixedCost(this.newFixedCost).subscribe(t=>{this.helper.toastSuccess(t.message),this.response.emit({success:!0})})}udpateFixedCost(){this._account.updateFixedCost(this.fixedCost).subscribe(t=>{this.helper.toastSuccess(t.message),this.response.emit({success:!0,data:t.data})})}selectSupplier(t){this.selectedSupplier=t.name,"add"==this.type?this.newFixedCost.supplier_id=t.id:this.fixedCost.supplier_id=t.id}supplierInputOut(){setTimeout(()=>{this.supplierInput=!1},200)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(Rt.Q),e.Y36(f.B),e.Y36(Z.B))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-add-edit-fixed-cost"]],inputs:{fixedCost:"fixedCost",type:"type"},outputs:{response:"response"},decls:14,vars:6,consts:[[1,"modal-header"],["class","modal-title",4,"ngIf"],["type","button","data-dismiss","modal",1,"close"],[1,"modal-body"],["class","row",4,"ngIf"],[1,"modal-footer"],[1,"d-flex","align-items-center","justify-content-center","w-100"],["href","javascript:void(0)",1,"discard-btn",3,"click"],["href","javascript:void(0)","class","add-btn",3,"click",4,"ngIf"],[1,"modal-title"],[1,"row"],[1,"col-md-12"],[1,"input-style","mb-2"],[1,"d-block"],[1,"red-label"],[1,"text-danger"],["type","text","placeholder","100",1,"ctm-input","type-input",3,"ngModel","ngModelChange"],["type","text","placeholder","H1-098",1,"ctm-input","type-input",3,"ngModel","ngModelChange"],[1,"select-box"],[1,"form-group","position-relative",3,"focusout"],["type","text","placeholder","Search supplier",1,"ctm-input","type-input",3,"ngModel","input","focus","ngModelChange"],["class","custom-dropdown-list",4,"ngIf"],["name","search",1,"input-icon"],[1,"form-group","position-relative"],["placeholder","Select Months",1,"ctm-input","bg-white",3,"change"],["value","null"],["value","January"],["value","February"],["value","March"],["value","April"],["value","May"],["value","June"],["value","July"],["value","August"],["value","September"],["value","October"],["value","November"],["value","December"],[1,"d-flex","flex-wrap"],["class","fiels-ctm",4,"ngFor","ngForOf"],[1,"custom-dropdown-list"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[1,"fiels-ctm"],["name","plus",1,"plus-rotate",3,"click"],["type","text","placeholder","H1-98",1,"ctm-input","type-input",3,"ngModel","ngModelChange"],["href","javascript:void(0)",1,"add-btn",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.YNc(1,Xt,2,0,"h4",1),e.YNc(2,Gt,2,0,"h4",1),e.TgZ(3,"button",2),e._uU(4,"\xd7"),e.qZA()(),e.TgZ(5,"div",3),e.YNc(6,nn,67,5,"div",4),e.YNc(7,an,67,5,"div",4),e.qZA(),e.TgZ(8,"div",5)(9,"div",6)(10,"a",7),e.NdJ("click",function(){return n.cancel()}),e._uU(11,"Discard"),e.qZA(),e.YNc(12,cn,2,0,"a",8),e.YNc(13,dn,2,0,"a",8),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("ngIf","add"==n.type),e.xp6(1),e.Q6J("ngIf","edit"==n.type),e.xp6(4),e.Q6J("ngIf","add"==n.type),e.xp6(1),e.Q6J("ngIf","edit"==n.type),e.xp6(5),e.Q6J("ngIf","add"==n.type),e.xp6(1),e.Q6J("ngIf","edit"==n.type))},directives:[c.O5,l.Fj,l.JJ,l.On,c.sg,h.u,l.YN,l.Kr],styles:[""]}),i})();function ln(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"a",25),e.NdJ("click",function(){return e.CHM(t),e.oxw().addFixedCost()}),e._UZ(1,"i-feather",26),e._uU(2,"Add Fixed Cost "),e.qZA()}}function _n(i,r){1&i&&e._UZ(0,"i",27)}function un(i,r){1&i&&e._UZ(0,"i",28)}function pn(i,r){1&i&&e._UZ(0,"i",27)}function hn(i,r){1&i&&e._UZ(0,"i",28)}function mn(i,r){1&i&&e._UZ(0,"i",27)}function gn(i,r){1&i&&e._UZ(0,"i",28)}function fn(i,r){1&i&&e._UZ(0,"i",27)}function Cn(i,r){1&i&&e._UZ(0,"i",28)}function Zn(i,r){1&i&&(e.TgZ(0,"th")(1,"p",18),e._uU(2,"Actions"),e.qZA()())}function vn(i,r){1&i&&(e.TgZ(0,"span"),e._uU(1,",\xa0"),e.qZA())}function Tn(i,r){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.YNc(2,vn,2,0,"span",21),e.qZA()),2&i){const t=r.$implicit,n=r.index,o=e.oxw().$implicit;e.xp6(1),e.Oqu(t),e.xp6(1),e.Q6J("ngIf",n!=o.cost_dates.length-1)}}function An(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"td")(1,"div",31)(2,"a",32),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(),s=o.$implicit,a=o.index;return e.oxw().editFixedCost(s,a)}),e._UZ(3,"i-feather",33),e.qZA(),e.TgZ(4,"a",32),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(),s=o.$implicit,a=o.index;return e.oxw().deleteFixedCost(s,a)}),e._UZ(5,"i-feather",34),e.qZA()()()}}function xn(i,r){if(1&i&&(e.TgZ(0,"tr",29)(1,"td")(2,"p",18),e._uU(3),e.qZA()(),e.TgZ(4,"td")(5,"p",18),e._uU(6),e.qZA()(),e.TgZ(7,"td")(8,"p",18),e._uU(9),e.qZA()(),e.TgZ(10,"td")(11,"p",18),e.YNc(12,Tn,3,2,"span",30),e.qZA()(),e.YNc(13,An,6,0,"td",21),e.qZA()),2&i){const t=r.$implicit,n=e.oxw();e.xp6(3),e.Oqu(t.order_number),e.xp6(3),e.Oqu(t.supplier.name),e.xp6(3),e.Oqu(t.value),e.xp6(3),e.Q6J("ngForOf",t.cost_dates),e.xp6(1),e.Q6J("ngIf",n._auth.checkPermissions("accounts","write"))}}let bn=(()=>{class i{constructor(t,n,o,s,a){this.ref=t,this._modal=n,this._account=o,this._auth=s,this.helper=a,this.costs=[],this.dateToday=new Date,this.modalConfig={animated:!0,keyboard:!1,backdrop:!1,ignoreBackdropClick:!0,windowClass:"modal-roles Fixed-cost-modal"},this.searchParams={search:"",page_size:10,page:1,sort_column:"order_number",sort_value:"ASC"},this.totalPages=1,this.pageFrom=1,this.pageTo=10,this.totalCount=10}ngOnInit(){this.getFixedCosts(),this.getNotifications()}getNotifications(){this.notificationSubscription=this.helper.currentNotification.subscribe(t=>{1==this.helper.checkNotification("fixed-cost","accounts",this.costs,t)?this.getFixedCosts():this.ref.detectChanges()})}getFixedCosts(){this._account.fixedCostListing(this.searchParams).subscribe(t=>{this.costs=t.data.data,this.searchParams.page_size=t.data.per_page,this.searchParams.page=t.data.current_page,this.totalPages=t.data.last_page,this.pageFrom=t.data.from,this.pageTo=t.data.to,this.totalCount=t.data.total})}addFixedCost(){const t=this._modal.open(F,this.modalConfig);t.componentInstance.response.subscribe(n=>{n.success&&this.getFixedCosts(),t.dismiss()})}editFixedCost(t,n){let o=JSON.parse(JSON.stringify(t));const s=this._modal.open(F,this.modalConfig);s.componentInstance.type="edit",s.componentInstance.fixedCost=o,s.componentInstance.response.subscribe(a=>{a.success&&(console.log(a),this.costs[n]=a.data),s.dismiss()})}deleteFixedCost(t,n){const o=this._modal.open(b.p,this.modalConfig);o.componentInstance.type="fixedCost",o.componentInstance.data=Object.assign({},t),o.componentInstance.response.subscribe(s=>{s.success&&this.costs.splice(n,1),o.dismiss()})}searchOrder(t,n=null){this.searchParams.page=1,"search"==t&&this.getFixedCosts()}changePage(t){this.searchParams.page=t,this.getFixedCosts()}ChangePageSize(t){this.searchParams.page=1,this.searchParams.page_size=t,this.getFixedCosts()}sortData(t){this.searchParams.sort_column=t,this.searchParams.sort_value="ASC"==this.searchParams.sort_value?"DESC":"ASC",console.log(this.searchParams),this.getFixedCosts()}ngOnDestroy(){this.notificationSubscription.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(e.sBO),e.Y36(v.FF),e.Y36(f.B),e.Y36(A.e),e.Y36(Z.B))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-fixed-cost"]],decls:49,vars:22,consts:[[1,"dashboard-main"],[1,"dashboard-content"],[1,"d-flex","align-items-center","mb-16","justify-content-between","mr-70"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","javascript:void(0)",1,"breadcrumb-link"],["href","javascript:void(0)",1,"breadcrumb-link","active"],[1,"roles-main","delivery-list-table"],[1,"d-flex","align-items-center","justify-content-between","delivery-list-main","fixed-cost-bar","p-1"],[1,"form-group","sear-bar-roles","position-relative","m-0"],["type","search","placeholder","Search..","id","email",1,"form-control","form-control-roles","m-0",3,"ngModel","input","ngModelChange"],["name","search",1,"search-ctm"],["class","secondary-sup","href","javascript:void(0)",3,"click",4,"ngIf"],[1,"tab-table"],[1,"tables-roles-main","tables-users-main","table-responsive"],[1,"table"],[1,"thead-ctm"],[3,"click"],[1,"inner-cell"],["class","fa fa-arrow-down sorting-arrow","aria-hidden","true",4,"ngIf"],["class","fa fa-arrow-up sorting-arrow","aria-hidden","true",4,"ngIf"],[4,"ngIf"],[1,"t-body-ctm"],["class","active-row",4,"ngFor","ngForOf"],[3,"from","to","pageSize","currentPage","totalPages","total","changePage","ChangePageSize"],["href","javascript:void(0)",1,"secondary-sup",3,"click"],["name","plus",1,"plus"],["aria-hidden","true",1,"fa","fa-arrow-down","sorting-arrow"],["aria-hidden","true",1,"fa","fa-arrow-up","sorting-arrow"],[1,"active-row"],[4,"ngFor","ngForOf"],[1,"list-icons-talbe","justify-content-center"],["href","javascript:void(0)",1,"icon-anchor-list",3,"click"],["name","edit-3",1,"icon-width"],["name","trash",1,"icon-width"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"ul",3)(4,"li",4)(5,"a",5),e._uU(6,"ACCOUNTS"),e.qZA()(),e.TgZ(7,"li",4)(8,"a",5),e._uU(9,"FIXED COST"),e.qZA()(),e.TgZ(10,"li",4)(11,"a",6),e._uU(12),e.ALo(13,"date"),e.qZA()()()(),e.TgZ(14,"div",7)(15,"div",8)(16,"div",9)(17,"input",10),e.NdJ("input",function(){return n.searchOrder("search")})("ngModelChange",function(s){return n.searchParams.search=s}),e.qZA(),e._UZ(18,"i-feather",11),e.qZA(),e.YNc(19,ln,3,0,"a",12),e.qZA(),e.TgZ(20,"div",13)(21,"div",14)(22,"table",15)(23,"thead",16)(24,"tr")(25,"th",17),e.NdJ("click",function(){return n.sortData("order_number")}),e.TgZ(26,"p",18),e._uU(27,"Order "),e.YNc(28,_n,1,0,"i",19),e.YNc(29,un,1,0,"i",20),e.qZA()(),e.TgZ(30,"th",17),e.NdJ("click",function(){return n.sortData("suppliers.name")}),e.TgZ(31,"p",18),e._uU(32,"Supplier "),e.YNc(33,pn,1,0,"i",19),e.YNc(34,hn,1,0,"i",20),e.qZA()(),e.TgZ(35,"th",17),e.NdJ("click",function(){return n.sortData("value")}),e.TgZ(36,"p",18),e._uU(37,"Value "),e.YNc(38,mn,1,0,"i",19),e.YNc(39,gn,1,0,"i",20),e.qZA()(),e.TgZ(40,"th",17),e.NdJ("click",function(){return n.sortData("dates")}),e.TgZ(41,"p",18),e._uU(42,"Dates "),e.YNc(43,fn,1,0,"i",19),e.YNc(44,Cn,1,0,"i",20),e.qZA()(),e.YNc(45,Zn,3,0,"th",21),e.qZA()(),e.TgZ(46,"tbody",22),e.YNc(47,xn,14,5,"tr",23),e.qZA()()(),e.TgZ(48,"app-pagination",24),e.NdJ("changePage",function(s){return n.changePage(s)})("ChangePageSize",function(s){return n.ChangePageSize(s)}),e.qZA()()()()()),2&t&&(e.xp6(12),e.hij("Week ",e.xi3(13,19,n.dateToday,"ww"),""),e.xp6(5),e.Q6J("ngModel",n.searchParams.search),e.xp6(2),e.Q6J("ngIf",n._auth.checkPermissions("accounts","write")),e.xp6(9),e.Q6J("ngIf","order_number"==n.searchParams.sort_column&&"DESC"==n.searchParams.sort_value),e.xp6(1),e.Q6J("ngIf","order_number"==n.searchParams.sort_column&&"ASC"==n.searchParams.sort_value),e.xp6(4),e.Q6J("ngIf","suppliers.name"==n.searchParams.sort_column&&"DESC"==n.searchParams.sort_value),e.xp6(1),e.Q6J("ngIf","suppliers.name"==n.searchParams.sort_column&&"ASC"==n.searchParams.sort_value),e.xp6(4),e.Q6J("ngIf","value"==n.searchParams.sort_column&&"DESC"==n.searchParams.sort_value),e.xp6(1),e.Q6J("ngIf","value"==n.searchParams.sort_column&&"ASC"==n.searchParams.sort_value),e.xp6(4),e.Q6J("ngIf","dates"==n.searchParams.sort_column&&"DESC"==n.searchParams.sort_value),e.xp6(1),e.Q6J("ngIf","dates"==n.searchParams.sort_column&&"ASC"==n.searchParams.sort_value),e.xp6(1),e.Q6J("ngIf",n._auth.checkPermissions("accounts","write")),e.xp6(2),e.Q6J("ngForOf",n.costs),e.xp6(1),e.Q6J("from",n.pageFrom)("to",n.pageTo)("pageSize",n.searchParams.page_size)("currentPage",n.searchParams.page)("totalPages",n.totalPages)("total",n.totalCount))},directives:[l.Fj,l.JJ,l.On,h.u,c.O5,c.sg,T.Q],pipes:[c.uU],styles:[".fixed-cost-bar[_ngcontent-%COMP%]{width:100%}"]}),i})();function On(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"i-feather",27),e.NdJ("click",function(){return e.CHM(t),e.oxw().startDate=null}),e.qZA()}}function kn(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"i-feather",27),e.NdJ("click",function(){return e.CHM(t),e.oxw().endDate=null}),e.qZA()}}function qn(i,r){1&i&&(e.TgZ(0,"th")(1,"p",22),e._uU(2,"Verify Invoice"),e.qZA()())}function wn(i,r){1&i&&(e.TgZ(0,"th")(1,"p",22),e._uU(2,"Actions"),e.qZA()())}function Un(i,r){1&i&&(e.TgZ(0,"span"),e._uU(1,", "),e.qZA())}function Pn(i,r){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.YNc(2,Un,2,0,"span",23),e.qZA()),2&i){const t=r.$implicit,n=r.index,o=e.oxw().$implicit;e.xp6(1),e.Oqu(t.work_number),e.xp6(1),e.Q6J("ngIf",n>=0&&n<o.quotation.work_orders.length-1)}}function Sn(i,r){1&i&&(e.TgZ(0,"p",22),e._uU(1,"Failed"),e.qZA())}function yn(i,r){1&i&&(e.TgZ(0,"p",22),e._uU(1,"Success"),e.qZA())}function Jn(i,r){1&i&&(e.TgZ(0,"p",22),e._uU(1,"Ready for invoice"),e.qZA())}function Mn(i,r){1&i&&(e.TgZ(0,"p",22),e._uU(1,"Processing"),e.qZA())}function Nn(i,r){1&i&&(e.TgZ(0,"p",22),e._uU(1,"--"),e.qZA())}function In(i,r){if(1&i&&(e.TgZ(0,"p",22),e._uU(1),e.ALo(2,"date"),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(e.xi3(2,1,t.invoiced_at,"dd-MM-yyyy @ hh:mm a"))}}function Fn(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"td")(1,"div",31)(2,"label",32)(3,"input",33),e.NdJ("change",function(o){e.CHM(t);const s=e.oxw().$implicit;return e.oxw().updateInvoiceStatus(s,o)}),e.qZA(),e._UZ(4,"span",34),e.qZA()()()}if(2&i){const t=e.oxw().$implicit;e.xp6(3),e.Q6J("checked",t.is_verified)}}function En(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"td")(1,"div",35)(2,"a",36),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(),s=o.$implicit,a=o.index;return e.oxw().resendInvoice(s,a)}),e._UZ(3,"i-feather",37),e.qZA()()()}}function Yn(i,r){if(1&i&&(e.TgZ(0,"tr",28)(1,"td")(2,"p",22),e.YNc(3,Pn,3,2,"span",29),e.qZA()(),e.TgZ(4,"td"),e.YNc(5,Sn,2,0,"p",30),e.YNc(6,yn,2,0,"p",30),e.YNc(7,Jn,2,0,"p",30),e.YNc(8,Mn,2,0,"p",30),e.qZA(),e.TgZ(9,"td")(10,"ul")(11,"li"),e._uU(12),e.qZA()()(),e.TgZ(13,"td"),e.YNc(14,Nn,2,0,"p",30),e.YNc(15,In,3,4,"p",30),e.qZA(),e.YNc(16,Fn,5,1,"td",23),e.YNc(17,En,4,0,"td",23),e.qZA()),2&i){const t=r.$implicit,n=e.oxw();e.xp6(3),e.Q6J("ngForOf",null==t||null==t.quotation?null:t.quotation.work_orders),e.xp6(2),e.Q6J("ngIf",n.checkInvoiceStatus(t)&&0==t.success),e.xp6(1),e.Q6J("ngIf",n.checkInvoiceStatus(t)&&1==t.success),e.xp6(1),e.Q6J("ngIf",n.checkInvoiceStatus(t)&&!t.invoiced_at),e.xp6(1),e.Q6J("ngIf",!n.checkInvoiceStatus(t)),e.xp6(4),e.Oqu(t.message),e.xp6(2),e.Q6J("ngIf",!t.invoiced_at),e.xp6(1),e.Q6J("ngIf",t.invoiced_at),e.xp6(1),e.Q6J("ngIf",n._auth.checkPermissions("accounts","write")),e.xp6(1),e.Q6J("ngIf",n._auth.checkPermissions("accounts","write")&&n.checkInvoiceStatus(t))}}const E=function(){return{isAnimated:!0,adaptivePosition:!0,dateInputFormat:"DD-MMM-YYYY",containerClass:"theme-red",selectFromOtherMonth:!0}};let Dn=(()=>{class i{constructor(t,n,o,s,a){this.ref=t,this._account=n,this._auth=o,this.helper=s,this.datePipe=a,this.invoices=[],this.dateToday=new Date,this.firstCall=!0,this.searchParams={search:"",start_date:null,end_date:null,page_size:10,page:1},this.totalPages=1,this.pageFrom=1,this.pageTo=10,this.totalCount=10}ngOnInit(){this.getInvoices(),this.getNotifications(),setTimeout(()=>{this.firstCall=!1},500)}getNotifications(){this.notificationSubscription=this.helper.currentNotification.subscribe(t=>{1==this.helper.checkNotification("sage","accounts",this.invoices,t)?this.getInvoices():this.ref.detectChanges()})}getInvoices(){this._account.sageInvoiceListing(this.searchParams).subscribe(t=>{this.invoices=t.data.data,this.searchParams.page_size=t.data.per_page,this.searchParams.page=t.data.current_page,this.totalPages=t.data.last_page,this.pageFrom=t.data.from,this.pageTo=t.data.to,this.totalCount=t.data.total})}resendInvoice(t,n){this._account.sageInvoiceCreate({id:t.id}).subscribe(o=>{this.invoices[n]=o.data})}checkInvoiceStatus(t){var n;return null==(null===(n=null==t?void 0:t.quotation)||void 0===n?void 0:n.work_orders.find(o=>"Delivered"!=o.status))}searchOrder(t,n=null){this.searchParams.page=1,"search"==t&&this.getInvoices(),setTimeout(()=>{"date"==t&&(this.startDate&&this.endDate||!this.startDate&&!this.endDate)&&!this.firstCall&&(this.searchParams.start_date=this.startDate?this.datePipe.transform(this.startDate,"YYYY-MM-dd"):null,this.searchParams.end_date=this.endDate?this.datePipe.transform(this.endDate,"YYYY-MM-dd"):null,this.getInvoices())},50)}changePage(t){this.searchParams.page=t,this.getInvoices()}ChangePageSize(t){this.searchParams.page=1,this.searchParams.page_size=t,this.getInvoices()}updateInvoiceStatus(t,n){this._account.sageInvoiceVerification({id:t.id,is_verified:n.target.checked}).subscribe(s=>{})}ngOnDestroy(){this.notificationSubscription.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(e.sBO),e.Y36(f.B),e.Y36(A.e),e.Y36(Z.B),e.Y36(c.uU))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-sage-invoices"]],decls:52,vars:23,consts:[[1,"dashboard-main"],[1,"dashboard-content"],[1,"d-flex","align-items-center","mb-16","justify-content-between","mr-70"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","javascript:void(0)",1,"breadcrumb-link"],["href","javascript:void(0)",1,"breadcrumb-link","active"],[1,"search-inputs","d-flex"],[1,"search-inputs","mr-10"],[1,"input-style"],[1,"type-pass"],["type","text","id","start_date","placeholder","From","name","start_date","bsDatepicker","","autocomplete","off",1,"ctm-input",3,"bsValue","bsConfig","maxDate","bsValueChange"],[1,"icon-eye","d-flex","align-items-center","justify-content-center"],["name","calendar",1,"calender"],["name","X","class","clear-filter",3,"click",4,"ngIf"],[1,"search-inputs"],["type","text","id","end_date","placeholder","To","name","end_date","bsDatepicker","","autocomplete","off",1,"ctm-input",3,"bsValue","bsConfig","minDate","bsValueChange"],[1,"roles-main","delivery-list-table"],[1,"tab-table"],[1,"tables-roles-main","tables-users-main","table-responsive"],[1,"table"],[1,"thead-ctm"],[1,"inner-cell"],[4,"ngIf"],[1,"t-body-ctm"],["class","active-row",4,"ngFor","ngForOf"],[3,"from","to","pageSize","currentPage","totalPages","total","changePage","ChangePageSize"],["name","X",1,"clear-filter",3,"click"],[1,"active-row"],[4,"ngFor","ngForOf"],["class","inner-cell",4,"ngIf"],[1,"checkbox-width","align-center"],[1,"custom-check"],["type","checkbox",3,"checked","change"],[1,"checkmark"],[1,"list-icons-talbe","justify-content-center"],["href","javascript:void(0)","placement","top","ngbTooltip","Resend",1,"icon-anchor-list",3,"click"],["name","send",1,"icon-width"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"ul",3)(4,"li",4)(5,"a",5),e._uU(6,"ACCOUNTS"),e.qZA()(),e.TgZ(7,"li",4)(8,"a",5),e._uU(9,"SAGE INVOICES"),e.qZA()(),e.TgZ(10,"li",4)(11,"a",6),e._uU(12),e.ALo(13,"date"),e.qZA()()(),e.TgZ(14,"div",7)(15,"div",8)(16,"div",9)(17,"div",10)(18,"input",11),e.NdJ("bsValueChange",function(){return n.searchOrder("date")})("bsValueChange",function(s){return n.startDate=s}),e.qZA(),e.TgZ(19,"div",12),e._UZ(20,"i-feather",13),e.qZA(),e.YNc(21,On,1,0,"i-feather",14),e.qZA()()(),e.TgZ(22,"div",15)(23,"div",9)(24,"div",10)(25,"input",16),e.NdJ("bsValueChange",function(){return n.searchOrder("date")})("bsValueChange",function(s){return n.endDate=s}),e.qZA(),e.TgZ(26,"div",12),e._UZ(27,"i-feather",13),e.qZA(),e.YNc(28,kn,1,0,"i-feather",14),e.qZA()()()()(),e.TgZ(29,"div",17)(30,"div",18)(31,"div",19)(32,"table",20)(33,"thead",21)(34,"tr")(35,"th")(36,"p",22),e._uU(37,"Work Numbers"),e.qZA()(),e.TgZ(38,"th")(39,"p",22),e._uU(40,"Status"),e.qZA()(),e.TgZ(41,"th")(42,"p",22),e._uU(43,"Message"),e.qZA()(),e.TgZ(44,"th")(45,"p",22),e._uU(46,"Invoice Sent At"),e.qZA()(),e.YNc(47,qn,3,0,"th",23),e.YNc(48,wn,3,0,"th",23),e.qZA()(),e.TgZ(49,"tbody",24),e.YNc(50,Yn,18,10,"tr",25),e.qZA()()(),e.TgZ(51,"app-pagination",26),e.NdJ("changePage",function(s){return n.changePage(s)})("ChangePageSize",function(s){return n.ChangePageSize(s)}),e.qZA()()()()()),2&t&&(e.xp6(12),e.hij("Week ",e.xi3(13,18,n.dateToday,"ww"),""),e.xp6(6),e.Q6J("bsValue",n.startDate)("bsConfig",e.DdM(21,E))("maxDate",n.endDate),e.xp6(3),e.Q6J("ngIf",n.startDate),e.xp6(4),e.Q6J("bsValue",n.endDate)("bsConfig",e.DdM(22,E))("minDate",n.startDate),e.xp6(3),e.Q6J("ngIf",n.endDate),e.xp6(19),e.Q6J("ngIf",n._auth.checkPermissions("accounts","write")),e.xp6(1),e.Q6J("ngIf",n._auth.checkPermissions("accounts","write")),e.xp6(2),e.Q6J("ngForOf",n.invoices),e.xp6(1),e.Q6J("from",n.pageFrom)("to",n.pageTo)("pageSize",n.searchParams.page_size)("currentPage",n.searchParams.page)("totalPages",n.totalPages)("total",n.totalCount))},directives:[p.Y5,p.Np,h.u,c.O5,c.sg,T.Q],pipes:[c.uU],styles:[".align-center[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}"]}),i})();function Qn(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"i-feather",47),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return o.startDate=null,o.searchOrder("date")}),e.qZA()}}function jn(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"i-feather",47),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return o.endDate=null,o.searchOrder("date")}),e.qZA()}}function Hn(i,r){1&i&&e._UZ(0,"i",48)}function Ln(i,r){1&i&&e._UZ(0,"i",49)}function $n(i,r){1&i&&e._UZ(0,"i",48)}function Vn(i,r){1&i&&e._UZ(0,"i",49)}function zn(i,r){1&i&&e._UZ(0,"i",48)}function Bn(i,r){1&i&&e._UZ(0,"i",49)}function Wn(i,r){1&i&&e._UZ(0,"i",48)}function Rn(i,r){1&i&&e._UZ(0,"i",49)}function Xn(i,r){1&i&&e._UZ(0,"i",48)}function Gn(i,r){1&i&&e._UZ(0,"i",49)}function Kn(i,r){1&i&&e._UZ(0,"i",48)}function ei(i,r){1&i&&e._UZ(0,"i",49)}function ti(i,r){1&i&&e._UZ(0,"i",48)}function ni(i,r){1&i&&e._UZ(0,"i",49)}function ii(i,r){1&i&&e._UZ(0,"i",48)}function oi(i,r){1&i&&e._UZ(0,"i",49)}function ri(i,r){1&i&&e._UZ(0,"i",48)}function si(i,r){1&i&&e._UZ(0,"i",49)}function ai(i,r){1&i&&(e.TgZ(0,"p",41),e._UZ(1,"i-feather",66),e.qZA())}function ci(i,r){1&i&&(e.TgZ(0,"p",41),e._uU(1,"-"),e.qZA())}function di(i,r){1&i&&(e.TgZ(0,"p",67),e._uU(1,"- "),e._UZ(2,"i-feather",68),e.qZA())}function li(i,r){if(1&i&&(e.TgZ(0,"a",69),e._uU(1),e._UZ(2,"i-feather",68),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.invoice_no," ")}}const O=function(i){return["delivery-notes",i]};function _i(i,r){if(1&i&&(e.TgZ(0,"a",70),e._uU(1,"Multiple"),e.qZA()),2&i){const t=e.oxw().$implicit;e.Q6J("routerLink",e.VKq(1,O,t.id))}}function ui(i,r){if(1&i&&(e.TgZ(0,"a",67),e._uU(1," - "),e._UZ(2,"i-feather",71),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(2),e.Q6J("routerLink",e.VKq(1,O,t.id))}}function pi(i,r){if(1&i&&(e.TgZ(0,"a",72),e._uU(1),e._UZ(2,"i-feather",68),e.qZA()),2&i){const t=e.oxw().$implicit;e.Q6J("routerLink",e.VKq(2,O,t.id)),e.xp6(1),e.hij(" ",null==t.delivery_notes[0]?null:t.delivery_notes[0].ticket_no," ")}}function hi(i,r){1&i&&(e.TgZ(0,"p",73),e._uU(1,"- "),e._UZ(2,"i-feather",68),e.qZA())}function mi(i,r){if(1&i&&(e.TgZ(0,"a",69),e._uU(1),e._UZ(2,"i-feather",68),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.schedule_ref," ")}}function gi(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"a",74),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(),s=o.$implicit,a=o.index;return e.oxw().addJobNote(s.id,a)}),e._uU(1," View "),e.qZA()}}function fi(i,r){if(1&i&&(e.TgZ(0,"div",75),e._UZ(1,"div",76),e.TgZ(2,"div",77),e._uU(3),e.ALo(4,"date"),e.qZA()()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("innerHtml",t.latest_job_note.description,e.oJD),e.xp6(2),e.hij(" ",e.xi3(4,2,t.latest_job_note.created_at,"h:mm a | dd LLLL, yyyy")," ")}}const Ci=function(i,r,t){return{"order-withdrawn":i,"order-to-factory":r,"order-storage":t}};function Zi(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"tr",50)(1,"td")(2,"p",41),e._uU(3),e.qZA()(),e.TgZ(4,"td")(5,"p",41),e._uU(6),e.qZA()(),e.TgZ(7,"td")(8,"p",41),e._uU(9),e.qZA()(),e.TgZ(10,"td")(11,"p",41),e._uU(12),e.qZA()(),e.TgZ(13,"td")(14,"p",41),e._uU(15),e.qZA()(),e.TgZ(16,"td")(17,"p",41),e._uU(18),e.qZA()(),e.TgZ(19,"td")(20,"p",41),e._uU(21),e.qZA()(),e.TgZ(22,"td")(23,"p",41),e._uU(24),e.qZA()(),e.TgZ(25,"td")(26,"p",41),e._uU(27),e.qZA()(),e.TgZ(28,"td",51)(29,"div",52),e._UZ(30,"span"),e.qZA(),e._uU(31),e.qZA(),e.TgZ(32,"td"),e.YNc(33,ai,2,0,"p",53),e.YNc(34,ci,2,0,"p",53),e.qZA(),e.TgZ(35,"td")(36,"div",54),e.YNc(37,di,3,0,"p",55),e.YNc(38,li,3,1,"a",56),e.qZA()(),e.TgZ(39,"td")(40,"div",54),e.YNc(41,_i,2,3,"a",57),e.YNc(42,ui,3,3,"a",55),e.YNc(43,pi,3,4,"a",58),e.qZA()(),e.TgZ(44,"td")(45,"p",41),e._uU(46),e.ALo(47,"date"),e.qZA()(),e.TgZ(48,"td")(49,"div",54),e.YNc(50,hi,3,0,"p",59),e.YNc(51,mi,3,1,"a",56),e.qZA()(),e.TgZ(52,"td")(53,"div",60),e.YNc(54,gi,2,0,"a",61),e.YNc(55,fi,5,5,"div",62),e.qZA()(),e.TgZ(56,"td")(57,"div",63)(58,"a",64),e.NdJ("click",function(){const o=e.CHM(t),s=o.$implicit,a=o.index;return e.oxw().viewTimeline(s,a)}),e._UZ(59,"i-feather",65),e.qZA()()()()}if(2&i){const t=r.$implicit;e.Q6J("ngClass",e.kEZ(28,Ci,"Withdrawn"==t.status||t.on_hold,"To Factory"==t.status&&!t.on_hold,"Withdrawn"!=t.status&&"To Factory"!=t.status&&!t.on_hold)),e.xp6(3),e.Oqu(t.work_number),e.xp6(3),e.Oqu(t.customer.name),e.xp6(3),e.Oqu(t.contract),e.xp6(3),e.Oqu(t.order_number),e.xp6(3),e.Oqu(t.product.name),e.xp6(3),e.Oqu("Doors"==t.product.name?t.sale_order.value:"0.00"),e.xp6(3),e.Oqu("Frame"==t.product.name?t.sale_order.value:"0.00"),e.xp6(3),e.Oqu("Doors"!=t.product.name&&"Frame"!=t.product.name?t.sale_order.value+t.sale_order.other:0==t.sale_order.other?"0.00":t.sale_order.other),e.xp6(3),e.Oqu(t.status),e.xp6(3),e.Udp("width",t.progress,"%"),e.xp6(1),e.hij("",t.progress,"% "),e.xp6(2),e.Q6J("ngIf",t.fsc),e.xp6(1),e.Q6J("ngIf",!t.fsc),e.xp6(3),e.Q6J("ngIf",!t.invoice_no&&!t.edit_invoice),e.xp6(1),e.Q6J("ngIf",t.invoice_no&&!t.edit_invoice),e.xp6(3),e.Q6J("ngIf",t.delivery_notes_count>1),e.xp6(1),e.Q6J("ngIf",0==t.delivery_notes_count),e.xp6(1),e.Q6J("ngIf",1==t.delivery_notes_count),e.xp6(3),e.Oqu(e.xi3(47,25,t.sale_order.month,"MMMM, YYYY")),e.xp6(4),e.Q6J("ngIf",!t.schedule_ref&&!t.edit_schedule_ref),e.xp6(1),e.Q6J("ngIf",t.schedule_ref&&!t.edit_schedule_ref),e.xp6(3),e.Q6J("ngIf","0"!=t.job_notes_count),e.xp6(1),e.Q6J("ngIf","0"!=t.job_notes_count&&t.latest_job_note.description)}}const Y=function(){return{isAnimated:!0,adaptivePosition:!0,dateInputFormat:"DD-MMM-YYYY",containerClass:"theme-red",selectFromOtherMonth:!0}},vi=[{path:"",component:St},{path:"credit-check",component:Wt},{path:"fixed-cost",component:bn},{path:"storage",component:(()=>{class i{constructor(t,n,o,s,a,d,m){this.ref=t,this._account=n,this._modal=o,this.helper=s,this.router=a,this.datePipe=d,this._auth=m,this.deliveryListView=1,this.deliveries=[],this.searchParams={search:"",start_date:null,end_date:null,page_size:10,page:1,sort_column:"work_number",sort_value:"DESC"},this.totalPages=1,this.pageFrom=1,this.pageTo=10,this.totalCount=10,this.checked=!1,this.checkAll=!1,this.modalConfig={animated:!0,keyboard:!1,backdrop:!1,ignoreBackdropClick:!0,windowClass:"modal-roles"},this.editDueDate=!1,this.dateToday=new Date,this.currentDate=null,this.totalOrder=0,this.totalOrdersValue=0}ngOnInit(){this.getStorageListing(),this.getNotifications()}getNotifications(){this.notificationSubscription=this.helper.currentNotification.subscribe(t=>{1==this.helper.checkNotification("storage","accounts",this.deliveries,t)?this.getStorageListing():this.ref.detectChanges()})}getStorageListing(){this.searchSubscription&&this.searchSubscription.unsubscribe(),this.searchSubscription=this._account.storageListing(this.searchParams).subscribe(t=>{let n=t.data.orders;this.totalOrder=t.data.total_orders_in_storage,this.totalOrdersValue=t.data.total_value,this.deliveries=n.data,this.searchParams.page_size=n.per_page,this.searchParams.page=n.current_page,this.totalPages=n.last_page,this.pageFrom=n.from,this.pageTo=n.to,this.totalCount=n.total})}viewTimeline(t,n){this.modalConfig.windowClass="modal-roles timeline";const o=this._modal.open(I.z,this.modalConfig);o.componentInstance.rod=Object.assign({},t),o.componentInstance.response.subscribe(s=>{s.success&&this.router.navigate(["rod/delivery-notes",t.id]),s.data&&(this.deliveries[n]=s.data),o.dismiss(),this.modalConfig.windowClass="modal-roles"})}addJobNote(t,n){this.modalConfig.windowClass="modal-roles job-notes-modal";const o=this._modal.open(N._,this.modalConfig);o.componentInstance.orderId=t,o.componentInstance.module="accounts",o.componentInstance.response.subscribe(s=>{s.success&&!s.close&&(this.deliveries[n]=s.data),s.success&&s.close&&o.dismiss(),s.close&&(this.getStorageListing(),o.dismiss(),this.modalConfig.windowClass="modal-roles")})}searchOrder(t,n=null){this.searchParams.page=1,"search"==t&&this.getStorageListing(),setTimeout(()=>{"date"==t&&(this.startDate&&this.endDate||!this.startDate&&!this.endDate)&&(this.searchParams.start_date=this.startDate?this.datePipe.transform(this.startDate,"YYYY-MM-dd"):null,this.searchParams.end_date=this.endDate?this.datePipe.transform(this.endDate,"YYYY-MM-dd"):null,this.getStorageListing())},50)}changePage(t){this.searchParams.page=t,this.getStorageListing()}ChangePageSize(t){this.searchParams.page=1,this.searchParams.page_size=t,this.getStorageListing()}sortData(t){this.searchParams.sort_column=t,this.searchParams.sort_value="ASC"==this.searchParams.sort_value?"DESC":"ASC",this.getStorageListing()}selectOptions(){this.checked=!!this.deliveries.find(t=>t.checked),this.checkAll=!this.deliveries.find(t=>!t.checked)}ngOnDestroy(){this.notificationSubscription.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(e.sBO),e.Y36(f.B),e.Y36(v.FF),e.Y36(Z.B),e.Y36(C.F0),e.Y36(c.uU),e.Y36(A.e))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-storage"]],decls:141,vars:46,consts:[[1,"dashboard-main"],[1,"dashboard-content"],[1,"d-flex","align-items-center","mb-16","justify-content-between","mr-70"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","javascript:void(0)",1,"breadcrumb-link"],["href","javascript:void(0)",1,"breadcrumb-link","active"],[1,"row"],[1,"col-md-6"],[1,"card-dash","card-storage"],[1,"d-flex","align-items-start","justify-content-between"],[1,"d-flex","align-items-start","justify-content-between","flex-column"],[1,"carder-heading"],[1,"carder-amount"],[1,"d-flex","justify-content-center","align-items-center"],[1,"carder-icons"],[1,"fa","fa-home"],[1,"carder-icons","cash"],[1,"fas","fa-money-bill-wave"],[1,"roles-main","delivery-list-table","pb-1"],[1,"d-flex","align-items-center","justify-content-between","delivery-list-main","mb-2"],[1,"d-flex","for-media-setts"],[1,"form-group","sear-bar-roles","position-relative","mb-0"],["type","search","placeholder","Search..","id","email",1,"form-control","form-control-roles",3,"ngModel","input","ngModelChange"],["name","search",1,"search-ctm"],[1,"search-inputs","d-flex"],[1,"search-inputs","mr-10"],[1,"input-style"],[1,"type-pass"],["type","text","id","start_date","placeholder","From","name","start_date","bsDatepicker","","autocomplete","off",1,"ctm-input",3,"bsValue","bsConfig","maxDate","bsValueChange"],[1,"icon-eye","d-flex","align-items-center","justify-content-center"],["name","calendar",1,"calender"],["name","X","class","clear-filter",3,"click",4,"ngIf"],[1,"search-inputs"],["type","text","id","end_date","placeholder","To","name","end_date","bsDatepicker","","autocomplete","off",1,"ctm-input",3,"bsValue","bsConfig","minDate","bsValueChange"],[1,"tab-content"],["id","Table-View",1,"tab-table","tab-pane","fade","show","in","d-block"],[1,"tables-roles-main","tables-users-main","table-responsive"],[1,"table"],[1,"thead-ctm"],[1,"cursor-pointer",3,"click"],[1,"inner-cell"],["class","fa fa-arrow-down sorting-arrow","aria-hidden","true",4,"ngIf"],["class","fa fa-arrow-up sorting-arrow","aria-hidden","true",4,"ngIf"],[1,"t-body-ctm"],["class","active-row",3,"ngClass",4,"ngFor","ngForOf"],[3,"from","to","pageSize","currentPage","totalPages","total","changePage","ChangePageSize"],["name","X",1,"clear-filter",3,"click"],["aria-hidden","true",1,"fa","fa-arrow-down","sorting-arrow"],["aria-hidden","true",1,"fa","fa-arrow-up","sorting-arrow"],[1,"active-row",3,"ngClass"],[1,"position-relative"],[1,"progress-cell-bar"],["class","inner-cell",4,"ngIf"],[1,"inner-cell","list-icons-talbe-sec"],["class","icon-anchor-list",4,"ngIf"],["class","icon-anchor-list","href","javascript:void(0)",4,"ngIf"],["class","icon-anchor-list red",3,"routerLink",4,"ngIf"],["class","icon-anchor-list","href","javascript:void(0)",3,"routerLink",4,"ngIf"],["class","inner-cell icon-anchor-list",4,"ngIf"],[1,"inner-cell","view-anchor-tooltip"],["class","view-anchor red","href","javascript:void(0)",3,"click",4,"ngIf"],["class","tooltiptext-view",4,"ngIf"],[1,"inner-cell","list-icons-talbe"],["href","javascript:void(0)","placement","top","ngbTooltip","Timeline",1,"icon-anchor-list",3,"click"],["name","trending-up",1,"icon-width"],["name","check"],[1,"icon-anchor-list"],["name","edit-2",1,"icon-width"],["href","javascript:void(0)",1,"icon-anchor-list"],[1,"icon-anchor-list","red",3,"routerLink"],["name","edit-2",1,"icon-width",3,"routerLink"],["href","javascript:void(0)",1,"icon-anchor-list",3,"routerLink"],[1,"inner-cell","icon-anchor-list"],["href","javascript:void(0)",1,"view-anchor","red",3,"click"],[1,"tooltiptext-view"],[1,"toop-hight",3,"innerHtml"],[1,"date-tooptip-iner"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"ul",3)(4,"li",4)(5,"a",5),e._uU(6,"ACCOUNTS"),e.qZA()(),e.TgZ(7,"li",4)(8,"a",5),e._uU(9,"STORAGE"),e.qZA()(),e.TgZ(10,"li",4)(11,"a",6),e._uU(12),e.ALo(13,"date"),e.qZA()()()(),e.TgZ(14,"div",7)(15,"div",8)(16,"div",9)(17,"div",10)(18,"div",11)(19,"div")(20,"h3",12),e._uU(21,"TOTAL WORK ORDERS IN STORAGE"),e.qZA()(),e.TgZ(22,"div")(23,"h3",13),e._uU(24),e.qZA()()(),e.TgZ(25,"div",14)(26,"div",15),e._UZ(27,"i",16),e.qZA()()()()(),e.TgZ(28,"div",8)(29,"div",9)(30,"div",10)(31,"div",11)(32,"div")(33,"h3",12),e._uU(34,"TOTAL VALUE"),e.qZA()(),e.TgZ(35,"div")(36,"h3",13),e._uU(37),e.ALo(38,"currency"),e.qZA()()(),e.TgZ(39,"div",14)(40,"div",17),e._UZ(41,"i",18),e.qZA()()()()()(),e.TgZ(42,"div",19)(43,"div",20)(44,"div",21)(45,"div",22)(46,"input",23),e.NdJ("input",function(){return n.searchOrder("search")})("ngModelChange",function(s){return n.searchParams.search=s}),e.qZA(),e._UZ(47,"i-feather",24),e.qZA(),e.TgZ(48,"div",25)(49,"div",26)(50,"div",27)(51,"div",28)(52,"input",29),e.NdJ("bsValueChange",function(){return n.searchOrder("date")})("bsValueChange",function(s){return n.startDate=s}),e.qZA(),e.TgZ(53,"div",30),e._UZ(54,"i-feather",31),e.qZA(),e.YNc(55,Qn,1,0,"i-feather",32),e.qZA()()(),e.TgZ(56,"div",33)(57,"div",27)(58,"div",28)(59,"input",34),e.NdJ("bsValueChange",function(){return n.searchOrder("date")})("bsValueChange",function(s){return n.endDate=s}),e.qZA(),e.TgZ(60,"div",30),e._UZ(61,"i-feather",31),e.qZA(),e.YNc(62,jn,1,0,"i-feather",32),e.qZA()()()()()(),e.TgZ(63,"div",35)(64,"div",36)(65,"div",37)(66,"table",38)(67,"thead",39)(68,"tr")(69,"th",40),e.NdJ("click",function(){return n.sortData("work_number")}),e.TgZ(70,"p",41),e._uU(71,"Work# "),e.YNc(72,Hn,1,0,"i",42),e.YNc(73,Ln,1,0,"i",43),e.qZA()(),e.TgZ(74,"th",40),e.NdJ("click",function(){return n.sortData("customers.name")}),e.TgZ(75,"p",41),e._uU(76,"Customer "),e.YNc(77,$n,1,0,"i",42),e.YNc(78,Vn,1,0,"i",43),e.qZA()(),e.TgZ(79,"th",40),e.NdJ("click",function(){return n.sortData("contract")}),e.TgZ(80,"p",41),e._uU(81,"Contract "),e.YNc(82,zn,1,0,"i",42),e.YNc(83,Bn,1,0,"i",43),e.qZA()(),e.TgZ(84,"th",40),e.NdJ("click",function(){return n.sortData("order_number")}),e.TgZ(85,"p",41),e._uU(86,"Order# "),e.YNc(87,Wn,1,0,"i",42),e.YNc(88,Rn,1,0,"i",43),e.qZA()(),e.TgZ(89,"th",40),e.NdJ("click",function(){return n.sortData("products.name")}),e.TgZ(90,"p",41),e._uU(91,"Product "),e.YNc(92,Xn,1,0,"i",42),e.YNc(93,Gn,1,0,"i",43),e.qZA()(),e.TgZ(94,"th")(95,"p",41),e._uU(96,"Door"),e.qZA()(),e.TgZ(97,"th")(98,"p",41),e._uU(99,"Frame"),e.qZA()(),e.TgZ(100,"th")(101,"p",41),e._uU(102,"Other"),e.qZA()(),e.TgZ(103,"th",40),e.NdJ("click",function(){return n.sortData("status")}),e.TgZ(104,"p",41),e._uU(105,"Status "),e.YNc(106,Kn,1,0,"i",42),e.YNc(107,ei,1,0,"i",43),e.qZA()(),e.TgZ(108,"th",40),e.NdJ("click",function(){return n.sortData("progress")}),e.TgZ(109,"p",41),e._uU(110,"Progress "),e.YNc(111,ti,1,0,"i",42),e.YNc(112,ni,1,0,"i",43),e.qZA()(),e.TgZ(113,"th",40),e.NdJ("click",function(){return n.sortData("fsc")}),e.TgZ(114,"p",41),e._uU(115,"FSC "),e.YNc(116,ii,1,0,"i",42),e.YNc(117,oi,1,0,"i",43),e.qZA()(),e.TgZ(118,"th",40),e.NdJ("click",function(){return n.sortData("invoice_no")}),e.TgZ(119,"p",41),e._uU(120,"Invoice "),e.YNc(121,ri,1,0,"i",42),e.YNc(122,si,1,0,"i",43),e.qZA()(),e.TgZ(123,"th")(124,"p",41),e._uU(125,"Delivery Note"),e.qZA()(),e.TgZ(126,"th")(127,"p",41),e._uU(128,"Month"),e.qZA()(),e.TgZ(129,"th")(130,"p",41),e._uU(131,"Sch Ref"),e.qZA()(),e.TgZ(132,"th")(133,"p",41),e._uU(134,"Job Notes"),e.qZA()(),e.TgZ(135,"th")(136,"p",41),e._uU(137,"Actions"),e.qZA()()()(),e.TgZ(138,"tbody",44),e.YNc(139,Zi,60,32,"tr",45),e.qZA()()(),e.TgZ(140,"app-pagination",46),e.NdJ("changePage",function(s){return n.changePage(s)})("ChangePageSize",function(s){return n.ChangePageSize(s)}),e.qZA()()()()()()),2&t&&(e.xp6(12),e.hij("Week ",e.xi3(13,37,n.dateToday,"ww"),""),e.xp6(12),e.Oqu(n.totalOrder),e.xp6(13),e.Oqu(e.Dn7(38,40,n.totalOrdersValue,"GBP","symbol")),e.xp6(9),e.Q6J("ngModel",n.searchParams.search),e.xp6(6),e.Q6J("bsValue",n.startDate)("bsConfig",e.DdM(44,Y))("maxDate",n.endDate),e.xp6(3),e.Q6J("ngIf",n.startDate),e.xp6(4),e.Q6J("bsValue",n.endDate)("bsConfig",e.DdM(45,Y))("minDate",n.startDate),e.xp6(3),e.Q6J("ngIf",n.endDate),e.xp6(10),e.Q6J("ngIf","work_number"==n.searchParams.sort_column&&"DESC"==n.searchParams.sort_value),e.xp6(1),e.Q6J("ngIf","work_number"==n.searchParams.sort_column&&"ASC"==n.searchParams.sort_value),e.xp6(4),e.Q6J("ngIf","customers.name"==n.searchParams.sort_column&&"DESC"==n.searchParams.sort_value),e.xp6(1),e.Q6J("ngIf","customers.name"==n.searchParams.sort_column&&"ASC"==n.searchParams.sort_value),e.xp6(4),e.Q6J("ngIf","contract"==n.searchParams.sort_column&&"DESC"==n.searchParams.sort_value),e.xp6(1),e.Q6J("ngIf","contract"==n.searchParams.sort_column&&"ASC"==n.searchParams.sort_value),e.xp6(4),e.Q6J("ngIf","order_number"==n.searchParams.sort_column&&"DESC"==n.searchParams.sort_value),e.xp6(1),e.Q6J("ngIf","order_number"==n.searchParams.sort_column&&"ASC"==n.searchParams.sort_value),e.xp6(4),e.Q6J("ngIf","products.name"==n.searchParams.sort_column&&"DESC"==n.searchParams.sort_value),e.xp6(1),e.Q6J("ngIf","products.name"==n.searchParams.sort_column&&"ASC"==n.searchParams.sort_value),e.xp6(13),e.Q6J("ngIf","status"==n.searchParams.sort_column&&"DESC"==n.searchParams.sort_value),e.xp6(1),e.Q6J("ngIf","status"==n.searchParams.sort_column&&"ASC"==n.searchParams.sort_value),e.xp6(4),e.Q6J("ngIf","progress"==n.searchParams.sort_column&&"DESC"==n.searchParams.sort_value),e.xp6(1),e.Q6J("ngIf","progress"==n.searchParams.sort_column&&"ASC"==n.searchParams.sort_value),e.xp6(4),e.Q6J("ngIf","fsc"==n.searchParams.sort_column&&"DESC"==n.searchParams.sort_value),e.xp6(1),e.Q6J("ngIf","fsc"==n.searchParams.sort_column&&"ASC"==n.searchParams.sort_value),e.xp6(4),e.Q6J("ngIf","invoice_no"==n.searchParams.sort_column&&"DESC"==n.searchParams.sort_value),e.xp6(1),e.Q6J("ngIf","invoice_no"==n.searchParams.sort_column&&"ASC"==n.searchParams.sort_value),e.xp6(17),e.Q6J("ngForOf",n.deliveries),e.xp6(1),e.Q6J("from",n.pageFrom)("to",n.pageTo)("pageSize",n.searchParams.page_size)("currentPage",n.searchParams.page)("totalPages",n.totalPages)("total",n.totalCount))},directives:[l.Fj,l.JJ,l.On,h.u,p.Y5,p.Np,c.O5,c.sg,c.mk,C.yS,C.rH,T.Q],pipes:[c.uU,c.H9],styles:[""]}),i})()},{path:"sage-invoices",component:Dn}];let Ti=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[C.Bz.forChild(vi)],C.Bz]}),i})();var Ai=u(5530),xi=u(9618);let bi=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[c.ez,Ti,l.u5,h.p.pick(Ai.kEt),xi.m,p.kn]]}),i})()}}]);